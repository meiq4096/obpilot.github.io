<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 5.4.0">


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">
  <meta name="google-site-verification" content="SQw8_IUq7jRAGcByCN97Jk4AQ4otwO-p0ope0GrrsEU">
  <meta name="baidu-site-verification" content="code-hEsLjFpoY4">

<link rel="stylesheet" href="/css/main.css">



<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.15.3/css/all.min.css" integrity="sha256-2H3fkXt6FEmrReK448mDVGKb3WW2ZZw35gI7vqHOE4Y=" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/animate.css@3.1.1/animate.min.css" integrity="sha256-PR7ttpcvz8qrF57fur/yAx1qXMFJeJFiA6pSzWi0OIE=" crossorigin="anonymous">

<script class="next-config" data-name="main" type="application/json">{"hostname":"obpilot.github.io","root":"/","images":"/images","scheme":"Pisces","version":"8.7.0","exturl":false,"sidebar":{"position":"left","display":"always","padding":18,"offset":12},"copycode":true,"bookmark":{"enable":true,"color":"#222","save":"auto"},"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"fadeInDown","post_body":"fadeInDown","coll_header":"fadeInLeft","sidebar":"fadeInUp"}},"prism":false,"i18n":{"placeholder":"Searching...","empty":"We didn't find any results for the search: ${query}","hits_time":"${hits} results found in ${time} ms","hits":"${hits} results found"}}</script><script src="/js/config.js"></script>
<meta name="description" content="IBM DB2 是美国IBM公司开发的一套关系型数据库管理系统，它主要的运行环境为UNIX（包括IBM自家的AIX）、Linux、IBM i（旧称OS&#x2F;400）、z&#x2F;OS，以及Windows服务器版本。其中 LINUX、UNIX 和Windows 平台又简称 LUW 开放平台。客户包含 省农信、农商行 以及一些中字头金融机构。 目前业界应该没有哪家国产数据库号称兼容 DB2， 所以 “去 DB2”">
<meta property="og:type" content="article">
<meta property="og:title" content="DB2 迁移 OceanBase 实践总结">
<meta property="og:url" content="http://obpilot.github.io/2021/08/30/DB2-%E8%BF%81%E7%A7%BB-OceanBase-%E5%AE%9E%E8%B7%B5%E6%80%BB%E7%BB%93/index.html">
<meta property="og:site_name" content="Hexo">
<meta property="og:description" content="IBM DB2 是美国IBM公司开发的一套关系型数据库管理系统，它主要的运行环境为UNIX（包括IBM自家的AIX）、Linux、IBM i（旧称OS&#x2F;400）、z&#x2F;OS，以及Windows服务器版本。其中 LINUX、UNIX 和Windows 平台又简称 LUW 开放平台。客户包含 省农信、农商行 以及一些中字头金融机构。 目前业界应该没有哪家国产数据库号称兼容 DB2， 所以 “去 DB2”">
<meta property="og:locale" content="en_US">
<meta property="og:image" content="http://obpilot.github.io/images/16289205000178.jpg">
<meta property="og:image" content="http://obpilot.github.io/images/16289206656037.jpg">
<meta property="article:published_time" content="2021-08-30T08:32:43.000Z">
<meta property="article:modified_time" content="2021-08-30T09:56:40.177Z">
<meta property="article:author" content="obpilot">
<meta property="article:tag" content="DB2">
<meta property="article:tag" content="OCEANBASE">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="http://obpilot.github.io/images/16289205000178.jpg">


<link rel="canonical" href="http://obpilot.github.io/2021/08/30/DB2-%E8%BF%81%E7%A7%BB-OceanBase-%E5%AE%9E%E8%B7%B5%E6%80%BB%E7%BB%93/">



<script class="next-config" data-name="page" type="application/json">{"sidebar":"","isHome":false,"isPost":true,"lang":"en","comments":true,"permalink":"http://obpilot.github.io/2021/08/30/DB2-%E8%BF%81%E7%A7%BB-OceanBase-%E5%AE%9E%E8%B7%B5%E6%80%BB%E7%BB%93/","path":"2021/08/30/DB2-迁移-OceanBase-实践总结/","title":"DB2 迁移 OceanBase 实践总结"}</script>

<script class="next-config" data-name="calendar" type="application/json">""</script>
<title>DB2 迁移 OceanBase 实践总结 | Hexo</title>
  




  <noscript>
    <link rel="stylesheet" href="/css/noscript.css">
  </noscript>
<!-- hexo injector head_end start -->
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/katex.min.css">

<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/hexo-math@4.0.0/dist/style.css">
<!-- hexo injector head_end end --></head>

<body itemscope itemtype="http://schema.org/WebPage" class="use-motion">
  <div class="headband"></div>

  <main class="main">
    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="Toggle navigation bar" role="button">
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <i class="logo-line"></i>
      <h1 class="site-title">Hexo</h1>
      <i class="logo-line"></i>
    </a>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
    </div>
  </div>
</div>



<nav class="site-nav">
  <ul class="main-menu menu">
        <li class="menu-item menu-item-home"><a href="/" rel="section"><i class="fa fa-home fa-fw"></i>Home</a></li>
        <li class="menu-item menu-item-about"><a href="/about/" rel="section"><i class="fa fa-user fa-fw"></i>About</a></li>
        <li class="menu-item menu-item-tags"><a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>Tags</a></li>
        <li class="menu-item menu-item-categories"><a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>Categories</a></li>
        <li class="menu-item menu-item-archives"><a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>Archives</a></li>
        <li class="menu-item menu-item-schedule"><a href="/schedule/" rel="section"><i class="fa fa-calendar fa-fw"></i>Schedule</a></li>
        <li class="menu-item menu-item-sitemap"><a href="/sitemap.xml" rel="section"><i class="fa fa-sitemap fa-fw"></i>Sitemap</a></li>
  </ul>
</nav>




</div>
        
  
  <div class="toggle sidebar-toggle" role="button">
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
  </div>

  <aside class="sidebar">

    <div class="sidebar-inner sidebar-nav-active sidebar-toc-active">
      <ul class="sidebar-nav">
        <li class="sidebar-nav-toc">
          Table of Contents
        </li>
        <li class="sidebar-nav-overview">
          Overview
        </li>
      </ul>

      <div class="sidebar-panel-container">
        <!--noindex-->
        <div class="post-toc-wrap sidebar-panel">
            <div class="post-toc animated"><ol class="nav"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E8%A1%A8%E7%BB%93%E6%9E%84%E8%BD%AC%E6%8D%A2"><span class="nav-number">1.</span> <span class="nav-text">表结构转换</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E8%87%AA%E5%A2%9E%E5%88%97%E7%B1%BB%E5%9E%8B"><span class="nav-number">1.1.</span> <span class="nav-text">自增列类型</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#DB2-%E7%9A%84-DATE-TIME-%E8%B7%9F-OB-ORACLE-%E7%9A%84-DATE-%E5%B7%AE%E5%BC%82%E9%97%AE%E9%A2%98"><span class="nav-number">1.2.</span> <span class="nav-text">DB2 的 DATE &#x2F; TIME 跟 OB(ORACLE) 的 DATE 差异问题</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%AD%97%E7%AC%A6%E9%9B%86%E9%97%AE%E9%A2%98"><span class="nav-number">1.3.</span> <span class="nav-text">字符集问题</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%AD%97%E7%AC%A6%E4%B8%B2%E9%95%BF%E5%BA%A6%E9%97%AE%E9%A2%98"><span class="nav-number">1.4.</span> <span class="nav-text">字符串长度问题</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E9%9D%9E%E7%A9%BA%E4%B8%8E%E7%A9%BA%E5%80%BC%E9%97%AE%E9%A2%98"><span class="nav-number">1.5.</span> <span class="nav-text">非空与空值问题</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E8%8C%83%E5%9B%B4%E5%88%86%E5%8C%BA%E8%A1%A8%E5%88%86%E5%8C%BA%E8%BE%B9%E7%95%8C%E9%97%AE%E9%A2%98"><span class="nav-number">1.6.</span> <span class="nav-text">范围分区表分区边界问题</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#SQL-%E8%AF%AD%E6%B3%95%E8%BD%AC%E6%8D%A2"><span class="nav-number">2.</span> <span class="nav-text">SQL 语法转换</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#rownumber-%E5%87%BD%E6%95%B0"><span class="nav-number">2.1.</span> <span class="nav-text">rownumber 函数</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#FETCH-FIRST-N-ROWS"><span class="nav-number">2.2.</span> <span class="nav-text">FETCH FIRST N ROWS</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%88%97%E5%90%8D%E9%87%8D%E5%A4%8D%E9%97%AE%E9%A2%98"><span class="nav-number">2.3.</span> <span class="nav-text">列名重复问题</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E8%A1%A8%E5%88%AB%E5%90%8D%E9%97%AE%E9%A2%98"><span class="nav-number">2.4.</span> <span class="nav-text">表别名问题</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#DB2-%E7%9A%84-ORACLE-%E5%85%BC%E5%AE%B9%E6%A8%A1%E5%BC%8F"><span class="nav-number">3.</span> <span class="nav-text">DB2 的 ORACLE 兼容模式</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#DB2-%E5%92%8C-OB-ORACLE-%E7%9A%84%E5%BC%82%E6%9E%84%E6%95%B0%E6%8D%AE%E5%90%8C%E6%AD%A5"><span class="nav-number">4.</span> <span class="nav-text">DB2 和 OB(ORACLE) 的异构数据同步</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%85%B6%E4%BB%96%E5%8F%82%E8%80%83"><span class="nav-number">5.</span> <span class="nav-text">其他参考</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E9%99%84%E5%BD%95"><span class="nav-number">6.</span> <span class="nav-text">附录</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#DB2-DOCKER-%E7%8E%AF%E5%A2%83%E6%90%AD%E5%BB%BA"><span class="nav-number">6.1.</span> <span class="nav-text">DB2 DOCKER 环境搭建</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#DATAX-FOR-OB-%E5%90%8C%E6%AD%A5%E4%BB%BB%E5%8A%A1%E6%96%87%E4%BB%B6%E7%A4%BA%E4%BE%8B"><span class="nav-number">6.2.</span> <span class="nav-text">DATAX FOR OB 同步任务文件示例</span></a></li></ol></li></ol></div>
        </div>
        <!--/noindex-->

        <div class="site-overview-wrap sidebar-panel">
          <div class="site-overview">
            <div class="site-author site-overview-item animated" itemprop="author" itemscope itemtype="http://schema.org/Person">
  <p class="site-author-name" itemprop="name">obpilot</p>
  <div class="site-description" itemprop="description">obpilot home</div>
</div>
<div class="site-state-wrap site-overview-item animated">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
        <a href="/archives/">
          <span class="site-state-item-count">4</span>
          <span class="site-state-item-name">posts</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
          <a href="/categories/">
        <span class="site-state-item-count">3</span>
        <span class="site-state-item-name">categories</span></a>
      </div>
      <div class="site-state-item site-state-tags">
          <a href="/tags/">
        <span class="site-state-item-count">6</span>
        <span class="site-state-item-name">tags</span></a>
      </div>
  </nav>
</div>
  <div class="links-of-author site-overview-item animated">
      <span class="links-of-author-item">
        <a href="https://github.com/obpilot" title="GitHub → https:&#x2F;&#x2F;github.com&#x2F;obpilot" rel="noopener" target="_blank"><i class="fab fa-github fa-fw"></i>GitHub</a>
      </span>
      <span class="links-of-author-item">
        <a href="mailto:qing.meiq@gmail.com" title="E-Mail → mailto:qing.meiq@gmail.com" rel="noopener" target="_blank"><i class="fa fa-envelope fa-fw"></i>E-Mail</a>
      </span>
      <span class="links-of-author-item">
        <a href="https://weibo.com/mq44944" title="Weibo → https:&#x2F;&#x2F;weibo.com&#x2F;mq44944" rel="noopener" target="_blank"><i class="fab fa-weibo fa-fw"></i>Weibo</a>
      </span>
  </div>



          </div>
        </div>
      </div>
        <div class="back-to-top animated" role="button" aria-label="Back to top">
          <i class="fa fa-arrow-up"></i>
          <span>0%</span>
        </div>
    </div>
  </aside>
  <div class="sidebar-dimmer"></div>


    </header>

    
  <div class="reading-progress-bar"></div>
  <a role="button" class="book-mark-link book-mark-link-fixed"></a>

<noscript>
  <div class="noscript-warning">Theme NexT works best with JavaScript enabled</div>
</noscript>


    <div class="main-inner post posts-expand">


  


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="en">
    <link itemprop="mainEntityOfPage" href="http://obpilot.github.io/2021/08/30/DB2-%E8%BF%81%E7%A7%BB-OceanBase-%E5%AE%9E%E8%B7%B5%E6%80%BB%E7%BB%93/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="obpilot">
      <meta itemprop="description" content="obpilot home">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Hexo">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          DB2 迁移 OceanBase 实践总结
        </h1>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">Posted on</span>
      

      <time title="Created: 2021-08-30 16:32:43 / Modified: 17:56:40" itemprop="dateCreated datePublished" datetime="2021-08-30T16:32:43+08:00">2021-08-30</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">In</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/%E6%9E%B6%E6%9E%84/" itemprop="url" rel="index"><span itemprop="name">架构</span></a>
        </span>
    </span>

  
    <span class="post-meta-item" title="Views" id="busuanzi_container_page_pv">
      <span class="post-meta-item-icon">
        <i class="far fa-eye"></i>
      </span>
      <span class="post-meta-item-text">Views: </span>
      <span id="busuanzi_value_page_pv"></span>
    </span>
    <span class="post-meta-break"></span>
    <span class="post-meta-item" title="Symbols count in article">
      <span class="post-meta-item-icon">
        <i class="far fa-file-word"></i>
      </span>
      <span class="post-meta-item-text">Symbols count in article: </span>
      <span>30k</span>
    </span>
    <span class="post-meta-item" title="Reading time">
      <span class="post-meta-item-icon">
        <i class="far fa-clock"></i>
      </span>
      <span class="post-meta-item-text">Reading time &asymp;</span>
      <span>27 mins.</span>
    </span>
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
        <p>IBM DB2 是美国IBM公司开发的一套关系型数据库管理系统，它主要的运行环境为UNIX（包括IBM自家的AIX）、Linux、IBM i（旧称OS/400）、z/OS，以及Windows服务器版本。其中 LINUX、UNIX 和Windows 平台又简称 LUW 开放平台。客户包含 省农信、农商行 以及一些中字头金融机构。</p>
<p>目前业界应该没有哪家国产数据库号称兼容 DB2， 所以 “去 DB2” ，业务的改造是不可避免的。业界数据库能力最接近 DB2 的是 ORACLE 数据库，而 OceanBase 又同时兼容 ORACLE 和 MySQL。所以 DB2 迁移到 OceanBase ，最佳选择是选择 ORACLE 租户类型。个别客户为了去 DB2 后不再被数据库厂商标准绑定，会选择 OceanBase的 MySQL 租户。<br>本文主要是总结 DB2 迁移到 OceanBase ORACLE 租户的经验。</p>
<p>首先要评估 DB2 的表结构在 OB(ORACLE) 上的兼容性。</p>
<span id="more"></span>

<h2 id="表结构转换"><a href="#表结构转换" class="headerlink" title="表结构转换"></a>表结构转换</h2><p>DB2 跟 OB(ORACLE) 的数据类型差异还是比较大，下面仅就常用的类型的典型差异举例说明。</p>
<h3 id="自增列类型"><a href="#自增列类型" class="headerlink" title="自增列类型"></a>自增列类型</h3><p>DB2 的 SQL 语法，在 OB(ORACLE) 里都可以找到对应的实现，但不完全一样。<br>DB2 的自增列（<code>IDENTITY</code>）语法 OB 3.2 版本开始支持。在那之前，需要应用使用 SEQUENCE 给列填充值。</p>
<ul>
<li>DB2 示例：</li>
</ul>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> t4 ( ID <span class="type">BIGINT</span> <span class="keyword">NOT</span> <span class="keyword">NULL</span> GENERATED <span class="keyword">BY</span> <span class="keyword">DEFAULT</span> <span class="keyword">AS</span> <span class="keyword">IDENTITY</span> (MAXVALUE <span class="number">9223372036854775807</span>), C1 <span class="type">VARCHAR</span> (<span class="number">50</span>) <span class="keyword">NOT</span> <span class="keyword">NULL</span> <span class="keyword">DEFAULT</span> <span class="string">&#x27;&#x27;</span> )  ;</span><br></pre></td></tr></table></figure>

<ul>
<li>ORACLE 示例：</li>
</ul>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> t4 (ID NUMBER GENERATED ALWAYS <span class="keyword">AS</span> <span class="keyword">IDENTITY</span> MINVALUE <span class="number">1</span> MAXVALUE <span class="number">9223372036854775807</span> <span class="keyword">NOT</span> <span class="keyword">NULL</span>, C1 VARCHAR2(<span class="number">50</span>) );</span><br></pre></td></tr></table></figure>

<p>二者写法 <code>NOT NULL</code> 的位置不同。</p>
<h3 id="DB2-的-DATE-TIME-跟-OB-ORACLE-的-DATE-差异问题"><a href="#DB2-的-DATE-TIME-跟-OB-ORACLE-的-DATE-差异问题" class="headerlink" title="DB2 的 DATE / TIME 跟 OB(ORACLE) 的 DATE 差异问题"></a>DB2 的 DATE / TIME 跟 OB(ORACLE) 的 DATE 差异问题</h3><p>默认情况下（指 DB2 不开启 ORACLE 兼容模式），DB2 的 DATE 只包含日期，TIME 只包含时间。而 OB(ORACLE) 的 DATE 包含日期和时间。</p>
<p>DB2: </p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">db2 <span class="operator">=</span><span class="operator">&gt;</span> <span class="keyword">DROP</span> <span class="keyword">TABLE</span> t1</span><br><span class="line">DB20000I  The <span class="keyword">SQL</span> command completed successfully.</span><br><span class="line">db2 <span class="operator">=</span><span class="operator">&gt;</span> <span class="keyword">CREATE</span> <span class="keyword">TABLE</span> t1(id <span class="type">bigint</span> <span class="keyword">NOT</span> <span class="keyword">NULL</span> <span class="keyword">PRIMARY</span> KEY ,c1 <span class="type">date</span> , c2 <span class="type">time</span>, c3 <span class="type">timestamp</span>)</span><br><span class="line">DB20000I  The <span class="keyword">SQL</span> command completed successfully.</span><br><span class="line">db2 <span class="operator">=</span><span class="operator">&gt;</span> <span class="keyword">INSERT</span> <span class="keyword">INTO</span> t1 <span class="keyword">values</span>(<span class="number">1</span>, sysdate,sysdate,<span class="built_in">current_timestamp</span> )</span><br><span class="line">DB20000I  The <span class="keyword">SQL</span> command completed successfully.</span><br><span class="line">db2 <span class="operator">=</span><span class="operator">&gt;</span> <span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> t1</span><br><span class="line"></span><br><span class="line">ID                   C1         C2       C3</span><br><span class="line"><span class="comment">-------------------- ---------- -------- --------------------------</span></span><br><span class="line">                   <span class="number">1</span> <span class="number">08</span><span class="operator">/</span><span class="number">14</span><span class="operator">/</span><span class="number">2021</span> <span class="number">05</span>:<span class="number">29</span>:<span class="number">55</span> <span class="number">2021</span><span class="number">-08</span><span class="number">-14</span><span class="number">-05.29</span><span class="number">.55</span><span class="number">.343157</span></span><br><span class="line"></span><br><span class="line">  <span class="number">1</span> record(s) selected.</span><br><span class="line"></span><br><span class="line">db2 <span class="operator">=</span><span class="operator">&gt;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>OB(ORACLE):</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">obclient<span class="operator">&gt;</span> <span class="keyword">DROP</span> <span class="keyword">TABLE</span> t1;</span><br><span class="line">Query OK, <span class="number">0</span> <span class="keyword">rows</span> affected (<span class="number">0.02</span> sec)</span><br><span class="line"></span><br><span class="line">obclient<span class="operator">&gt;</span> <span class="keyword">CREATE</span> <span class="keyword">TABLE</span> t1(id number <span class="keyword">NOT</span> <span class="keyword">NULL</span> <span class="keyword">PRIMARY</span> KEY ,c1 <span class="type">date</span> , c3 <span class="type">timestamp</span>);</span><br><span class="line">Query OK, <span class="number">0</span> <span class="keyword">rows</span> affected (<span class="number">0.04</span> sec)</span><br><span class="line"></span><br><span class="line">obclient<span class="operator">&gt;</span> <span class="keyword">INSERT</span> <span class="keyword">INTO</span> t1 <span class="keyword">values</span>(<span class="number">1</span>, sysdate,<span class="built_in">current_timestamp</span>);</span><br><span class="line">Query OK, <span class="number">1</span> <span class="type">row</span> affected (<span class="number">0.01</span> sec)</span><br><span class="line"></span><br><span class="line">obclient<span class="operator">&gt;</span> <span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> t1;</span><br><span class="line"><span class="operator">+</span><span class="comment">----+---------------------+----------------------------+</span></span><br><span class="line"><span class="operator">|</span> ID <span class="operator">|</span> C1                  <span class="operator">|</span> C3                         <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">----+---------------------+----------------------------+</span></span><br><span class="line"><span class="operator">|</span>  <span class="number">1</span> <span class="operator">|</span> <span class="number">2021</span><span class="number">-08</span><span class="number">-14</span> <span class="number">13</span>:<span class="number">28</span>:<span class="number">15</span> <span class="operator">|</span> <span class="number">2021</span><span class="number">-08</span><span class="number">-14</span> <span class="number">13</span>:<span class="number">28</span>:<span class="number">15.177911</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">----+---------------------+----------------------------+</span></span><br><span class="line"><span class="number">1</span> <span class="type">row</span> <span class="keyword">in</span> <span class="keyword">set</span> (<span class="number">0.00</span> sec)</span><br></pre></td></tr></table></figure>


<h3 id="字符集问题"><a href="#字符集问题" class="headerlink" title="字符集问题"></a>字符集问题</h3><p>如果 DB2 字符集已经是 UTF-8 ，那可以直接转换为 OB(ORACLE) 的 UTF8MB4 。UTF8MB4 是 UTF8 的超集，多一些表情字符。</p>
<p>如果 DB2 字符集不是 UTF-8 ，也建议转换为 OB(ORACLE) 的 UTF8MB4，相关字符串字段长度需要在 OB(ORACLE) 里放大。如果是单向同步，这个没问题。如果还要考虑 OB(ORACLE) 数据回流到 DB2，可能会出现实际字符串数据超长问题。</p>
<p>查看 DB2 数据库字符集方法： </p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">[db2inst1@9a9fd42bf525 ~]$ db2 get db cfg <span class="keyword">for</span> testdb |grep -i code</span><br><span class="line"> Database code page                                      = 1208</span><br><span class="line"> Database code <span class="built_in">set</span>                                       = utf-8</span><br><span class="line"> Database country/region code                            = 1</span><br><span class="line"> [db2inst1@a32408ac626d ~]$ db2 get db cfg <span class="keyword">for</span> testdb|grep -i national</span><br><span class="line"> National character string mapping       (NCHAR_MAPPING) = CHAR_CU32</span><br></pre></td></tr></table></figure>
<p> 查看 OB(ORACLE) 租户字符集方法<br> <figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"> MySQL [(<span class="keyword">none</span>)]<span class="operator">&gt;</span> <span class="keyword">show</span> variables <span class="keyword">like</span> <span class="string">&#x27;%character%&#x27;</span>;</span><br><span class="line"><span class="operator">+</span><span class="comment">--------------------------+-----------+</span></span><br><span class="line"><span class="operator">|</span> VARIABLE_NAME            <span class="operator">|</span> <span class="keyword">VALUE</span>     <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">--------------------------+-----------+</span></span><br><span class="line"><span class="operator">|</span> character_set_client     <span class="operator">|</span> utf8mb4   <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> character_set_connection <span class="operator">|</span> utf8mb4   <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> character_set_filesystem <span class="operator">|</span> <span class="type">binary</span>    <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> character_set_results    <span class="operator">|</span> utf8mb4   <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> character_set_system     <span class="operator">|</span> utf8mb4   <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> nls_characterset         <span class="operator">|</span> AL32UTF8  <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> nls_nchar_characterset   <span class="operator">|</span> AL16UTF16 <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> nls_numeric_characters   <span class="operator">|</span> .,        <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">--------------------------+-----------+</span></span><br><span class="line"><span class="number">8</span> <span class="keyword">rows</span> <span class="keyword">in</span> <span class="keyword">set</span> (<span class="number">0.003</span> sec)</span><br></pre></td></tr></table></figure></p>
<p>OB(ORACLE) 的参数 <code>nls_characterset</code> 定义了数据库的字符集，通常是 <code>AL32UTF8</code>，每个中文字符字长为 3 个字节。 同时 <code>nls_nchar_characterset</code> 定义了 Unicode字符串使用的字符集，每个中文字符字长 2 个字节。</p>
<h3 id="字符串长度问题"><a href="#字符串长度问题" class="headerlink" title="字符串长度问题"></a>字符串长度问题</h3><p>DB2 和 ORACLE 都有参数定义一个 字符存储时对应多少字节。这个会影响一个列里最多能存储几个中文字符。</p>
<ul>
<li>DB2 查看字长单位方法</li>
</ul>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">[db2inst1@8d6dd8adcacf ~]$ db2 get db cfg <span class="keyword">for</span> testdb |grep -i string</span><br><span class="line"> Default string units                     (STRING_UNITS) = SYSTEM</span><br><span class="line"> National character string mapping       (NCHAR_MAPPING) = CHAR_CU32</span><br></pre></td></tr></table></figure>

<p>当字符集是 <code>Unicode</code> 时，</p>
<ul>
<li>如果 <code>STRING_UNITS</code> 值为 <code>SYSTEM</code> ，则 CHAR, VARCHAR, and CLOB 类型的长度在不指定 <code>CODEUNITS32</code> 时，会默认为是 <code>OCTETS</code> 。</li>
<li>如果 <code>STRING_UNITS</code> 值为 <code>CODEUNITS32</code> 时，则默认长度是 <code>CODEUNITS32</code>。</li>
</ul>
<p>字符串长度单位说明： </p>
<ul>
<li><code>OCTETS</code> : 使用字节作为字符的单位。</li>
<li><code>CODEUNITS16</code>：使用 <code>UTF-16</code> 编码作为字符的单位，长度为 2 个 字节。</li>
<li><code>CODEUNITS32</code>：使用 <code>UTF-32</code> 编码作为字符的单位，长度为 4 个字节。</li>
</ul>
<p><code>NCHAR_MAPPING</code> 取值为 <code>CHAR_CU32</code> 时，<code>NCHAR</code> 、<code>NVARCHAR</code> 和 <code>NCLOB</code> 列字符默认单位是 <code>CODEUNITS32</code> 。</p>
<ul>
<li>OB(ORACLE) 查看字长单位方法。</li>
</ul>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">obclient<span class="operator">&gt;</span> <span class="keyword">show</span> <span class="keyword">global</span> variables <span class="keyword">like</span> <span class="string">&#x27;%nls_length_semantics%&#x27;</span>;</span><br><span class="line"><span class="operator">+</span><span class="comment">----------------------+-------+</span></span><br><span class="line"><span class="operator">|</span> VARIABLE_NAME        <span class="operator">|</span> <span class="keyword">VALUE</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">----------------------+-------+</span></span><br><span class="line"><span class="operator">|</span> nls_length_semantics <span class="operator">|</span> BYTE  <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">----------------------+-------+</span></span><br><span class="line"><span class="number">1</span> <span class="type">row</span> <span class="keyword">in</span> <span class="keyword">set</span> (<span class="number">0.00</span> sec)</span><br></pre></td></tr></table></figure>

<p>参数 <code>nls_length_semantics</code> 是在租户下设置，只影响当前租户。取值有两种：</p>
<ul>
<li><code>BYTE</code> : 使用字节作为字符的单位。</li>
<li><code>CHAR</code> : 使用字符作为单位。每个字符多少个字节跟字符集设置有关。字符集是 <code>UTF-8</code>的时候，每个中文字符 3 个字节。</li>
</ul>
<p>下面的示例方便具体理解 DB2 跟 OB(ORACLE) 的字符长度差异。</p>
<ul>
<li>DB2 字符长度示例</li>
</ul>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">db2 <span class="operator">=</span><span class="operator">&gt;</span> <span class="keyword">DROP</span> <span class="keyword">TABLE</span> t2;</span><br><span class="line">DB20000I  The <span class="keyword">SQL</span> command completed successfully.</span><br><span class="line">db2 <span class="operator">=</span><span class="operator">&gt;</span> <span class="keyword">CREATE</span> <span class="keyword">TABLE</span> t2(id <span class="type">bigint</span> <span class="keyword">NOT</span> <span class="keyword">NULL</span> <span class="keyword">PRIMARY</span> KEY, c1 <span class="type">char</span>(<span class="number">50</span>), c2 <span class="type">varchar</span>(<span class="number">50</span>), c3 <span class="type">nchar</span>(<span class="number">50</span>), c4 nvarchar(<span class="number">50</span>));</span><br><span class="line">DB20000I  The <span class="keyword">SQL</span> command completed successfully.</span><br><span class="line">db2 <span class="operator">=</span><span class="operator">&gt;</span> <span class="keyword">INSERT</span> <span class="keyword">INTO</span> t2 <span class="keyword">values</span>(<span class="number">1</span>,<span class="string">&#x27;中&#x27;</span>,<span class="string">&#x27;中&#x27;</span>,<span class="string">&#x27;中&#x27;</span>,<span class="string">&#x27;中&#x27;</span>);</span><br><span class="line">DB20000I  The <span class="keyword">SQL</span> command completed successfully.</span><br><span class="line">db2 <span class="operator">=</span><span class="operator">&gt;</span> <span class="keyword">INSERT</span> <span class="keyword">INTO</span> t2 <span class="keyword">values</span>(<span class="number">2</span>,<span class="string">&#x27;中国&#x27;</span>,<span class="string">&#x27;中国&#x27;</span>,<span class="string">&#x27;中国&#x27;</span>,<span class="string">&#x27;中国&#x27;</span>);</span><br><span class="line">DB20000I  The <span class="keyword">SQL</span> command completed successfully.</span><br><span class="line">db2 <span class="operator">=</span><span class="operator">&gt;</span> <span class="keyword">SELECT</span> id, c1, length(c1) c1_length,lengthb(c1) c1_lengthb,c2,length(c2) c2_length,lengthb(c2) c2_lengthb, c3, length(c3) c3_length, lengthb(c3) c3_lengthb,c4, length(c4) c4_length,lengthb(c4) c4_lengthb <span class="keyword">FROM</span> t2;</span><br><span class="line"></span><br><span class="line">ID                   C1                                                 C1_LENGTH   C1_LENGTHB  C2                                                 C2_LENGTH   C2_LENGTHB  C3                                                                                                   C3_LENGTH   C3_LENGTHB  C4                                                                                                   C4_LENGTH   C4_LENGTHB</span><br><span class="line"><span class="comment">-------------------- -------------------------------------------------- ----------- ----------- -------------------------------------------------- ----------- ----------- ---------------------------------------------------------------------------------------------------- ----------- ----------- ---------------------------------------------------------------------------------------------------- ----------- -----------</span></span><br><span class="line">                   <span class="number">1</span> 中                                                         <span class="number">50</span>          <span class="number">50</span> 中                                                          <span class="number">6</span>           <span class="number">6</span> 中                                                                                                           <span class="number">50</span>          <span class="number">53</span> 中                                                                                                            <span class="number">3</span>           <span class="number">6</span></span><br><span class="line">                   <span class="number">2</span> 中国                                                      <span class="number">50</span>          <span class="number">50</span> 中国                                                      <span class="number">12</span>          <span class="number">12</span> 中国                                                                                                        <span class="number">50</span>          <span class="number">56</span> 中国                                                                                                         <span class="number">6</span>          <span class="number">12</span></span><br><span class="line"></span><br><span class="line">  <span class="number">2</span> record(s) selected.</span><br></pre></td></tr></table></figure>
<p>  <img src="/images/16289205000178.jpg"></p>
<ul>
<li>ORACLE 字符长度示例</li>
</ul>
  <figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">  obclient<span class="operator">&gt;</span> <span class="keyword">DROP</span> <span class="keyword">TABLE</span> t2;</span><br><span class="line">Query OK, <span class="number">0</span> <span class="keyword">rows</span> affected (<span class="number">0.02</span> sec)</span><br><span class="line"></span><br><span class="line">obclient<span class="operator">&gt;</span> <span class="keyword">CREATE</span> <span class="keyword">TABLE</span> t2(id number <span class="keyword">NOT</span> <span class="keyword">NULL</span> <span class="keyword">PRIMARY</span> KEY, c1 <span class="type">char</span>(<span class="number">50</span>), c2 varchar2(<span class="number">50</span>), c3 <span class="type">nchar</span>(<span class="number">50</span>), c4 nvarchar2(<span class="number">50</span>));</span><br><span class="line">Query OK, <span class="number">0</span> <span class="keyword">rows</span> affected (<span class="number">0.05</span> sec)</span><br><span class="line"></span><br><span class="line">obclient<span class="operator">&gt;</span> <span class="keyword">INSERT</span> <span class="keyword">INTO</span> t2 <span class="keyword">values</span>(<span class="number">1</span>,<span class="string">&#x27;中&#x27;</span>,<span class="string">&#x27;中&#x27;</span>,<span class="string">&#x27;中&#x27;</span>,<span class="string">&#x27;中&#x27;</span>);</span><br><span class="line">Query OK, <span class="number">1</span> <span class="type">row</span> affected (<span class="number">0.00</span> sec)</span><br><span class="line"></span><br><span class="line">obclient<span class="operator">&gt;</span> <span class="keyword">INSERT</span> <span class="keyword">INTO</span> t2 <span class="keyword">values</span>(<span class="number">2</span>,<span class="string">&#x27;中国&#x27;</span>,<span class="string">&#x27;中国&#x27;</span>,<span class="string">&#x27;中国&#x27;</span>,<span class="string">&#x27;中国&#x27;</span>);</span><br><span class="line">Query OK, <span class="number">1</span> <span class="type">row</span> affected (<span class="number">0.00</span> sec)</span><br><span class="line"></span><br><span class="line">obclient<span class="operator">&gt;</span> <span class="keyword">SELECT</span> id, c1, length(c1) c1_length,lengthb(c1) c1_lengthb,c2,length(c2) c2_length,lengthb(c2) c2_lengthb, c3, length(c3) c3_length, lengthb(c3) c3_lengthb,c4, length(c4) c4_length,lengthb(c4) c4_lengthb <span class="keyword">FROM</span> t2;</span><br><span class="line"><span class="operator">+</span><span class="comment">----+----------------------------------------------------+-----------+------------+--------+-----------+------------+--------------------------------------------------------+-----------+------------+--------+-----------+------------+</span></span><br><span class="line"><span class="operator">|</span> ID <span class="operator">|</span> C1                                                 <span class="operator">|</span> C1_LENGTH <span class="operator">|</span> C1_LENGTHB <span class="operator">|</span> C2     <span class="operator">|</span> C2_LENGTH <span class="operator">|</span> C2_LENGTHB <span class="operator">|</span> C3                                                     <span class="operator">|</span> C3_LENGTH <span class="operator">|</span> C3_LENGTHB <span class="operator">|</span> C4     <span class="operator">|</span> C4_LENGTH <span class="operator">|</span> C4_LENGTHB <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">----+----------------------------------------------------+-----------+------------+--------+-----------+------------+--------------------------------------------------------+-----------+------------+--------+-----------+------------+</span></span><br><span class="line"><span class="operator">|</span>  <span class="number">1</span> <span class="operator">|</span> 中                                                 <span class="operator">|</span>        <span class="number">48</span> <span class="operator">|</span>         <span class="number">50</span> <span class="operator">|</span> 中     <span class="operator">|</span>         <span class="number">1</span> <span class="operator">|</span>          <span class="number">3</span> <span class="operator">|</span> 中                                                     <span class="operator">|</span>        <span class="number">50</span> <span class="operator">|</span>        <span class="number">100</span> <span class="operator">|</span>  中     <span class="operator">|</span>         <span class="number">1</span> <span class="operator">|</span>          <span class="number">2</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span>  <span class="number">2</span> <span class="operator">|</span> 中国                                               <span class="operator">|</span>        <span class="number">46</span> <span class="operator">|</span>         <span class="number">50</span> <span class="operator">|</span> 中国   <span class="operator">|</span>         <span class="number">2</span> <span class="operator">|</span>          <span class="number">6</span> <span class="operator">|</span> 中国                                                   <span class="operator">|</span>        <span class="number">50</span> <span class="operator">|</span>        <span class="number">100</span> <span class="operator">|</span>  中国   <span class="operator">|</span>         <span class="number">2</span> <span class="operator">|</span>          <span class="number">4</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">----+----------------------------------------------------+-----------+------------+--------+-----------+------------+--------------------------------------------------------+-----------+------------+--------+-----------+------------+</span></span><br><span class="line"><span class="number">2</span> <span class="keyword">rows</span> <span class="keyword">in</span> <span class="keyword">set</span> (<span class="number">0.01</span> sec)</span><br></pre></td></tr></table></figure>
<p>  <img src="/images/16289206656037.jpg"></p>
<h3 id="非空与空值问题"><a href="#非空与空值问题" class="headerlink" title="非空与空值问题"></a>非空与空值问题</h3><p>在 DB2 里，空值 跟 <code>NULL</code> 是两个值，并不相等。但是在 OB(ORACLE) 里，空值就是 <code>NULL</code> 。<br>针对是否是 <code>NULL</code> 只能用 <code>IS NULL</code> 或者 <code>IS NOT NULL</code> 判断，而不能用等值符号判断。在 DB2 里针对是否是空值，是用等值符号判断。<br>所以，DB2 的应用如果定义了很多 <code>NOT NULL</code> 列，但实际又允许写入空值，这个应用迁移到 OB(ORACLE) 是会报错的。解决办法只能是拿掉 OB(ORACLE) 列的 <code>NOT NULL</code> 属性。</p>
<ul>
<li>DB2 示例</li>
</ul>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line">db2 <span class="operator">=</span><span class="operator">&gt;</span> <span class="keyword">DROP</span> <span class="keyword">TABLE</span> t3;</span><br><span class="line">DB20000I  The <span class="keyword">SQL</span> command completed successfully.</span><br><span class="line">db2 <span class="operator">=</span><span class="operator">&gt;</span> <span class="keyword">CREATE</span> <span class="keyword">TABLE</span> t3(id <span class="type">bigint</span> <span class="keyword">NOT</span> <span class="keyword">NULL</span> <span class="keyword">PRIMARY</span> KEY, c1 <span class="type">varchar</span>(<span class="number">50</span>) <span class="keyword">NOT</span> <span class="keyword">NULL</span> , c2 <span class="type">varchar</span>(<span class="number">50</span>) <span class="keyword">NULL</span> );</span><br><span class="line">DB20000I  The <span class="keyword">SQL</span> command completed successfully.</span><br><span class="line">db2 <span class="operator">=</span><span class="operator">&gt;</span> <span class="keyword">INSERT</span> <span class="keyword">INTO</span> t3 <span class="keyword">values</span>(<span class="number">1</span>, <span class="string">&#x27;&#x27;</span>, <span class="string">&#x27;&#x27;</span>);</span><br><span class="line">DB20000I  The <span class="keyword">SQL</span> command completed successfully.</span><br><span class="line">db2 <span class="operator">=</span><span class="operator">&gt;</span> <span class="keyword">INSERT</span> <span class="keyword">INTO</span> t3 <span class="keyword">values</span>(<span class="number">2</span>, <span class="string">&#x27; &#x27;</span>, <span class="string">&#x27;&#x27;</span>);</span><br><span class="line">DB20000I  The <span class="keyword">SQL</span> command completed successfully.</span><br><span class="line">db2 <span class="operator">=</span><span class="operator">&gt;</span> <span class="keyword">SELECT</span> id, c1, hex(c1), c2, hex(c2) <span class="keyword">FROM</span> t3 ;</span><br><span class="line"></span><br><span class="line">ID                   C1                                                 <span class="number">3</span>                                                                                                    C2                                                 <span class="number">5</span></span><br><span class="line"><span class="comment">-------------------- -------------------------------------------------- ---------------------------------------------------------------------------------------------------- -------------------------------------------------- ----------------------------------------------------------------------------------------------------</span></span><br><span class="line">                   <span class="number">1</span></span><br><span class="line">                   <span class="number">2</span>                                                    <span class="number">20</span></span><br><span class="line"></span><br><span class="line">  <span class="number">2</span> record(s) selected.</span><br><span class="line"></span><br><span class="line">db2 <span class="operator">=</span><span class="operator">&gt;</span> <span class="keyword">SELECT</span> id, c1, hex(c1), c2, hex(c2) <span class="keyword">FROM</span> t3 <span class="keyword">WHERE</span> c1 <span class="keyword">IS</span> <span class="keyword">NULL</span> ;</span><br><span class="line"></span><br><span class="line">ID                   C1                                                 <span class="number">3</span>                                                                                                    C2                                                 <span class="number">5</span></span><br><span class="line"><span class="comment">-------------------- -------------------------------------------------- ---------------------------------------------------------------------------------------------------- -------------------------------------------------- ----------------------------------------------------------------------------------------------------</span></span><br><span class="line"></span><br><span class="line">  <span class="number">0</span> record(s) selected.</span><br><span class="line"></span><br><span class="line">db2 <span class="operator">=</span><span class="operator">&gt;</span> <span class="keyword">SELECT</span> id, c1, hex(c1), c2, hex(c2) <span class="keyword">FROM</span> t3 <span class="keyword">WHERE</span> c1 <span class="operator">=</span> <span class="string">&#x27;&#x27;</span>;</span><br><span class="line"></span><br><span class="line">ID                   C1                                                 <span class="number">3</span>                                                                                                    C2                                                 <span class="number">5</span></span><br><span class="line"><span class="comment">-------------------- -------------------------------------------------- ---------------------------------------------------------------------------------------------------- -------------------------------------------------- ----------------------------------------------------------------------------------------------------</span></span><br><span class="line">                   <span class="number">1</span></span><br><span class="line">                   <span class="number">2</span>                                                    <span class="number">20</span></span><br><span class="line"></span><br><span class="line">  <span class="number">2</span> record(s) selected.</span><br><span class="line"></span><br><span class="line">db2 <span class="operator">=</span><span class="operator">&gt;</span></span><br></pre></td></tr></table></figure>

<ul>
<li>ORACLE 示例</li>
</ul>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line">obclient<span class="operator">&gt;</span> <span class="keyword">DROP</span> <span class="keyword">TABLE</span> t3;</span><br><span class="line">Query OK, <span class="number">0</span> <span class="keyword">rows</span> affected (<span class="number">0.02</span> sec)</span><br><span class="line"></span><br><span class="line">obclient<span class="operator">&gt;</span> <span class="keyword">CREATE</span> <span class="keyword">TABLE</span> t3(id number <span class="keyword">NOT</span> <span class="keyword">NULL</span> <span class="keyword">PRIMARY</span> KEY, c1 varchar2(<span class="number">50</span>) <span class="keyword">NOT</span> <span class="keyword">NULL</span> , c2 varchar2(<span class="number">50</span>) <span class="keyword">NULL</span> );</span><br><span class="line">Query OK, <span class="number">0</span> <span class="keyword">rows</span> affected (<span class="number">0.05</span> sec)</span><br><span class="line"></span><br><span class="line">obclient<span class="operator">&gt;</span> <span class="keyword">INSERT</span> <span class="keyword">INTO</span> t3 <span class="keyword">values</span>(<span class="number">1</span>, <span class="string">&#x27;&#x27;</span>, <span class="string">&#x27;&#x27;</span>);</span><br><span class="line">ORA<span class="number">-01400</span>: cannot <span class="keyword">insert</span> <span class="keyword">NULL</span> <span class="keyword">into</span> <span class="string">&#x27;(C1)&#x27;</span></span><br><span class="line">obclient<span class="operator">&gt;</span> <span class="keyword">INSERT</span> <span class="keyword">INTO</span> t3 <span class="keyword">values</span>(<span class="number">2</span>, <span class="string">&#x27; &#x27;</span>, <span class="string">&#x27;&#x27;</span>);</span><br><span class="line">Query OK, <span class="number">1</span> <span class="type">row</span> affected (<span class="number">0.00</span> sec)</span><br><span class="line"></span><br><span class="line">obclient<span class="operator">&gt;</span> <span class="keyword">SELECT</span> id, c1, dump(c1), c2, dump(c2,<span class="number">16</span>) <span class="keyword">FROM</span> t3 ;</span><br><span class="line"><span class="operator">+</span><span class="comment">----+----+------------------+------+-------------+</span></span><br><span class="line"><span class="operator">|</span> ID <span class="operator">|</span> C1 <span class="operator">|</span> DUMP(C1)         <span class="operator">|</span> C2   <span class="operator">|</span> DUMP(C2,<span class="number">16</span>) <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">----+----+------------------+------+-------------+</span></span><br><span class="line"><span class="operator">|</span>  <span class="number">2</span> <span class="operator">|</span>    <span class="operator">|</span> Typ<span class="operator">=</span><span class="number">22</span> Len<span class="operator">=</span><span class="number">1</span>: <span class="number">32</span> <span class="operator">|</span> <span class="keyword">NULL</span> <span class="operator">|</span> <span class="keyword">NULL</span>        <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">----+----+------------------+------+-------------+</span></span><br><span class="line"><span class="number">1</span> <span class="type">row</span> <span class="keyword">in</span> <span class="keyword">set</span> (<span class="number">0.01</span> sec)</span><br><span class="line"></span><br><span class="line">obclient<span class="operator">&gt;</span> <span class="keyword">SELECT</span> id, c1, dump(c1), c2, dump(c2,<span class="number">16</span>) <span class="keyword">FROM</span> t3 <span class="keyword">WHERE</span> c1 <span class="keyword">IS</span> <span class="keyword">NULL</span> ;</span><br><span class="line"><span class="keyword">Empty</span> <span class="keyword">set</span> (<span class="number">0.00</span> sec)</span><br><span class="line"></span><br><span class="line">obclient<span class="operator">&gt;</span> <span class="keyword">SELECT</span> id, c1, dump(c1), c2, dump(c2,<span class="number">16</span>) <span class="keyword">FROM</span> t3 <span class="keyword">WHERE</span> c1 <span class="operator">=</span> <span class="string">&#x27;&#x27;</span>;</span><br><span class="line"><span class="keyword">Empty</span> <span class="keyword">set</span> (<span class="number">0.00</span> sec)</span><br><span class="line"></span><br><span class="line">obclient<span class="operator">&gt;</span> <span class="keyword">SELECT</span> id, c1, dump(c1), c2, dump(c2,<span class="number">16</span>) <span class="keyword">FROM</span> t3 <span class="keyword">WHERE</span> c1 <span class="operator">=</span> <span class="string">&#x27; &#x27;</span>;</span><br><span class="line"><span class="operator">+</span><span class="comment">----+----+------------------+------+-------------+</span></span><br><span class="line"><span class="operator">|</span> ID <span class="operator">|</span> C1 <span class="operator">|</span> DUMP(C1)         <span class="operator">|</span> C2   <span class="operator">|</span> DUMP(C2,<span class="number">16</span>) <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">----+----+------------------+------+-------------+</span></span><br><span class="line"><span class="operator">|</span>  <span class="number">2</span> <span class="operator">|</span>    <span class="operator">|</span> Typ<span class="operator">=</span><span class="number">22</span> Len<span class="operator">=</span><span class="number">1</span>: <span class="number">32</span> <span class="operator">|</span> <span class="keyword">NULL</span> <span class="operator">|</span> <span class="keyword">NULL</span>        <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">----+----+------------------+------+-------------+</span></span><br><span class="line"><span class="number">1</span> <span class="type">row</span> <span class="keyword">in</span> <span class="keyword">set</span> (<span class="number">0.01</span> sec)</span><br><span class="line"></span><br><span class="line">obclient<span class="operator">&gt;</span></span><br></pre></td></tr></table></figure>

<h3 id="范围分区表分区边界问题"><a href="#范围分区表分区边界问题" class="headerlink" title="范围分区表分区边界问题"></a>范围分区表分区边界问题</h3><p>DB2 的范围分区表语法 跟 OB(ORACLE) 语法在指定分区的范围时语法完全不一样。除此之外，边界值也有不同逻辑。<br>DB2 的 RANGE 分区在定义分区边界时，可以通过在 起始值 和 结束值后面带上选项 <code>INCLUSIVE</code> 或 <code>EXCLUSIVE</code> ，以表示是否包含边界值。不指定的时候就是默认为 <code>INCLUSIVE</code>（包含边界值）。OB(ORACLE) 没有这个语法，默认分区范围就是不包含边界值，且只能指定上限，不能执行下限。<br>所以，DB2 的分区表分区范围不要使用 <code>INCLUSIVE</code> 选项，要明确指定 <code>EXCLUSIVE</code> 选项；否则，转换为 OB(ORACLE) 的时候要调整分区范围的起始值和结束值。</p>
<ul>
<li>DB2 示例</li>
</ul>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line">[db2inst1<span class="variable">@8d6dd8adcacf</span> <span class="operator">~</span>]$ db2 &quot;DROP TABLE t6;&quot;</span><br><span class="line">DB20000I  The <span class="keyword">SQL</span> command completed successfully.</span><br><span class="line">[db2inst1<span class="variable">@a32408ac626d</span> <span class="operator">~</span>]$ db2 &quot;CREATE TABLE t6(</span><br><span class="line">&gt; id bigint NOT NULL,</span><br><span class="line">&gt; c1 varchar(50),</span><br><span class="line">&gt; c2 timestamp NOT NULL ,</span><br><span class="line">&gt; PRIMARY KEY (id)</span><br><span class="line">&gt; ) PARTITION BY RANGE(c2)</span><br><span class="line">&gt; ( PARTITION P1 STARTING &#x27;1/1/2020&#x27; ENDING &#x27;1/31/2020&#x27; INCLUSIVE ,</span><br><span class="line">&gt; PARTITION P2 STARTING &#x27;2/1/2020&#x27; ENDING &#x27;2/28/2020&#x27; INCLUSIVE ,</span><br><span class="line">&gt; PARTITION P3 STARTING &#x27;3/1/2020&#x27; ENDING &#x27;3/31/2020&#x27; INCLUSIVE ,</span><br><span class="line">&gt; PARTITION P4 STARTING &#x27;4/1/2020&#x27; ENDING &#x27;4/30/2020&#x27; INCLUSIVE ,</span><br><span class="line">&gt; PARTITION P5 STARTING &#x27;5/1/2020&#x27; ENDING &#x27;5/31/2020&#x27; INCLUSIVE</span><br><span class="line">&gt; );&quot;</span><br><span class="line">DB20000I  The <span class="keyword">SQL</span> command completed successfully.</span><br><span class="line">[db2inst1<span class="variable">@a32408ac626d</span> <span class="operator">~</span>]$ db2 &quot;INSERT INTO t6(id,c1,c2) values(1,&#x27;A&#x27;,&#x27;1/1/2020&#x27;);&quot;</span><br><span class="line">DB20000I  The <span class="keyword">SQL</span> command completed successfully.</span><br><span class="line">[db2inst1<span class="variable">@a32408ac626d</span> <span class="operator">~</span>]$ db2 &quot;INSERT INTO t6(id,c1,c2) values(2,&#x27;B&#x27;,&#x27;5/31/2020&#x27;);&quot;</span><br><span class="line">DB20000I  The <span class="keyword">SQL</span> command completed successfully.</span><br><span class="line">[db2inst1<span class="variable">@a32408ac626d</span> <span class="operator">~</span>]$ db2 &quot;INSERT INTO t6(id,c1,c2) values(3,&#x27;C&#x27;,&#x27;12/31/2019&#x27;);&quot;</span><br><span class="line">DB21034E  The command was processed <span class="keyword">as</span> an <span class="keyword">SQL</span> statement because it was <span class="keyword">not</span> a</span><br><span class="line">valid Command Line Processor command.  During <span class="keyword">SQL</span> processing it returned:</span><br><span class="line">SQL0327N  The <span class="type">row</span> cannot be inserted <span class="keyword">into</span> <span class="keyword">table</span> &quot;JXXD.T6&quot; because it <span class="keyword">is</span></span><br><span class="line">outside the bounds <span class="keyword">of</span> the defined data <span class="keyword">partition</span> ranges.  <span class="keyword">SQLSTATE</span><span class="operator">=</span><span class="number">22525</span></span><br><span class="line">[db2inst1<span class="variable">@a32408ac626d</span> <span class="operator">~</span>]$</span><br><span class="line">[db2inst1<span class="variable">@a32408ac626d</span> <span class="operator">~</span>]$ db2 &quot;SELECT * FROM t6;&quot;</span><br><span class="line"></span><br><span class="line">ID                   C1                                                 C2</span><br><span class="line"><span class="comment">-------------------- -------------------------------------------------- --------------------------</span></span><br><span class="line">                   <span class="number">1</span> A                                                  <span class="number">2020</span><span class="number">-01</span><span class="number">-01</span><span class="number">-00.00</span><span class="number">.00</span><span class="number">.000000</span></span><br><span class="line">                   <span class="number">2</span> B                                                  <span class="number">2020</span><span class="number">-05</span><span class="number">-31</span><span class="number">-00.00</span><span class="number">.00</span><span class="number">.000000</span></span><br><span class="line"></span><br><span class="line">  <span class="number">2</span> record(s) selected.</span><br><span class="line"></span><br><span class="line">[db2inst1<span class="variable">@a32408ac626d</span> <span class="operator">~</span>]$</span><br><span class="line"></span><br></pre></td></tr></table></figure>


<ul>
<li>ORACLE 用法</li>
</ul>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">obclient<span class="operator">&gt;</span> <span class="keyword">CREATE</span> <span class="keyword">TABLE</span> t6(</span><br><span class="line">    <span class="operator">-</span><span class="operator">&gt;</span> id number <span class="keyword">NOT</span> <span class="keyword">NULL</span>,</span><br><span class="line">    <span class="operator">-</span><span class="operator">&gt;</span> c1 <span class="type">varchar</span>(<span class="number">50</span>),</span><br><span class="line">    <span class="operator">-</span><span class="operator">&gt;</span> c2 <span class="type">timestamp</span> <span class="keyword">NOT</span> <span class="keyword">NULL</span> ,</span><br><span class="line">    <span class="operator">-</span><span class="operator">&gt;</span> <span class="keyword">PRIMARY</span> KEY (id,c2)</span><br><span class="line">    <span class="operator">-</span><span class="operator">&gt;</span> ) <span class="keyword">PARTITION</span> <span class="keyword">BY</span> <span class="keyword">RANGE</span>(c2)</span><br><span class="line">    <span class="operator">-</span><span class="operator">&gt;</span> ( <span class="keyword">PARTITION</span> P1 <span class="keyword">VALUES</span> LESS THAN ( to_date(<span class="string">&#x27;2020/02/01&#x27;</span>,<span class="string">&#x27;YYYY/MM/DD&#x27;</span>)),</span><br><span class="line">    <span class="operator">-</span><span class="operator">&gt;</span> <span class="keyword">PARTITION</span> P2 <span class="keyword">VALUES</span> LESS THAN ( to_date( <span class="string">&#x27;2020/03/01&#x27;</span>,<span class="string">&#x27;YYYY/MM/DD&#x27;</span>)),</span><br><span class="line">    <span class="operator">-</span><span class="operator">&gt;</span> <span class="keyword">PARTITION</span> P3 <span class="keyword">VALUES</span> LESS THAN ( to_date( <span class="string">&#x27;2020/04/01&#x27;</span>,<span class="string">&#x27;YYYY/MM/DD&#x27;</span>)),</span><br><span class="line">    <span class="operator">-</span><span class="operator">&gt;</span> <span class="keyword">PARTITION</span> P4 <span class="keyword">VALUES</span> LESS THAN ( to_date( <span class="string">&#x27;2020/05/01&#x27;</span>,<span class="string">&#x27;YYYY/MM/DD&#x27;</span>)),</span><br><span class="line">    <span class="operator">-</span><span class="operator">&gt;</span> <span class="keyword">PARTITION</span> P5 <span class="keyword">VALUES</span> LESS THAN ( to_date( <span class="string">&#x27;2020/06/01&#x27;</span>,<span class="string">&#x27;YYYY/MM/DD&#x27;</span>))</span><br><span class="line">    <span class="operator">-</span><span class="operator">&gt;</span> );</span><br><span class="line">Query OK, <span class="number">0</span> <span class="keyword">rows</span> affected (<span class="number">0.09</span> sec)</span><br><span class="line"></span><br><span class="line">obclient<span class="operator">&gt;</span> <span class="keyword">INSERT</span> <span class="keyword">INTO</span> t6(id,c1,c2) <span class="keyword">values</span>(<span class="number">1</span>,<span class="string">&#x27;A&#x27;</span>,to_date(<span class="string">&#x27;2020/01/01&#x27;</span>,<span class="string">&#x27;YYYY/MM/DD&#x27;</span>));</span><br><span class="line">Query OK, <span class="number">1</span> <span class="type">row</span> affected (<span class="number">0.01</span> sec)</span><br><span class="line"></span><br><span class="line">obclient<span class="operator">&gt;</span> <span class="keyword">INSERT</span> <span class="keyword">INTO</span> t6(id,c1,c2) <span class="keyword">values</span>(<span class="number">2</span>,<span class="string">&#x27;B&#x27;</span>,to_date(<span class="string">&#x27;2020/03/01&#x27;</span>,<span class="string">&#x27;YYYY/MM/DD&#x27;</span>));</span><br><span class="line">Query OK, <span class="number">1</span> <span class="type">row</span> affected (<span class="number">0.00</span> sec)</span><br><span class="line"></span><br><span class="line">obclient<span class="operator">&gt;</span> <span class="keyword">INSERT</span> <span class="keyword">INTO</span> t6(id,c1,c2) <span class="keyword">values</span>(<span class="number">3</span>,<span class="string">&#x27;C&#x27;</span>,to_date(<span class="string">&#x27;2020/06/01&#x27;</span>,<span class="string">&#x27;YYYY/MM/DD&#x27;</span>));</span><br><span class="line">ORA<span class="number">-14400</span>: inserted <span class="keyword">partition</span> key does <span class="keyword">not</span> map <span class="keyword">to</span> <span class="keyword">any</span> <span class="keyword">partition</span></span><br><span class="line">obclient<span class="operator">&gt;</span></span><br></pre></td></tr></table></figure>


<h2 id="SQL-语法转换"><a href="#SQL-语法转换" class="headerlink" title="SQL 语法转换"></a>SQL 语法转换</h2><p>除了数据类型问题外，有些常用 SQL 写法也许要微调。</p>
<h3 id="rownumber-函数"><a href="#rownumber-函数" class="headerlink" title="rownumber 函数"></a><code>rownumber</code> 函数</h3><p>DB2 里有 <code>rownumber</code> 和 <code>row_number</code> 函数，作用一样，但是 OB(ORACLE) 只有 <code>row_number</code> 函数。如果业务使用的是 <code>rownumber</code>，那么要调整一下 SQL。</p>
<p>DB2 应用通常把 <code>rownumber</code>  和 <code>FETCH FIRST N ROWS</code> 结合使用来进行分页，在 OB(ORACLE) 3.1 版本之前，需要转换为 OB(ORACLE) 的分页方法。</p>
<ul>
<li>DB2 示例</li>
</ul>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> t5 <span class="keyword">AS</span> (<span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> SYSIBM.TABLES ) <span class="keyword">WITH</span> DATA ;</span><br><span class="line"></span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> </span><br><span class="line"><span class="keyword">FROM</span> (</span><br><span class="line">	<span class="keyword">SELECT</span> <span class="built_in">row_number</span>() <span class="keyword">OVER</span> (<span class="keyword">ORDER</span> <span class="keyword">BY</span> <span class="keyword">ORDER</span> <span class="keyword">OF</span> t5) rn , <span class="operator">*</span> <span class="keyword">FROM</span> t5</span><br><span class="line">	<span class="keyword">ORDER</span> <span class="keyword">BY</span> table_schema, table_type </span><br><span class="line">	<span class="keyword">FETCH</span> <span class="keyword">FIRST</span> <span class="number">100</span> <span class="keyword">ROWS</span> <span class="keyword">ONLY</span> </span><br><span class="line">	<span class="keyword">WITH</span> ur </span><br><span class="line">) t </span><br><span class="line"><span class="keyword">WHERE</span> rn <span class="operator">&gt;=</span><span class="number">90</span>;</span><br></pre></td></tr></table></figure>

<p>业务在写这类 SQL 的时候可能会不写最里面的 <code>ORDER BY </code> 语句，这样性能会快很多。但是结果集的顺序就是不确定。需要确认是否符合业务需求。</p>
<ul>
<li>OB(ORACLE) 示例</li>
</ul>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> t5 <span class="keyword">AS</span> <span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> all_objects;</span><br><span class="line">EXPLAIN EXTENDED_NOADDR </span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> (</span><br><span class="line">	<span class="keyword">SELECT</span> rownum rn, owner, object_name, object_type, created, last_ddl_time</span><br><span class="line">	<span class="keyword">FROM</span> (</span><br><span class="line">		<span class="keyword">SELECT</span> <span class="operator">*</span> </span><br><span class="line">		<span class="keyword">FROM</span> t5</span><br><span class="line">		<span class="keyword">ORDER</span> <span class="keyword">BY</span> owner,object_name</span><br><span class="line">	) <span class="keyword">WHERE</span> rownum <span class="operator">&lt;</span> <span class="operator">=</span><span class="number">100</span></span><br><span class="line">) <span class="keyword">WHERE</span> rn <span class="operator">&gt;=</span><span class="number">90</span></span><br><span class="line">;</span><br><span class="line"></span><br><span class="line"><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span></span><br><span class="line"><span class="operator">|</span>ID<span class="operator">|</span>OPERATOR      <span class="operator">|</span>NAME <span class="operator">|</span>EST. <span class="keyword">ROWS</span><span class="operator">|</span>COST<span class="operator">|</span></span><br><span class="line"><span class="comment">----------------------------------------</span></span><br><span class="line"><span class="operator">|</span><span class="number">0</span> <span class="operator">|</span>COUNT         <span class="operator">|</span>     <span class="operator">|</span><span class="number">11</span>       <span class="operator">|</span><span class="number">1143</span><span class="operator">|</span></span><br><span class="line"><span class="operator">|</span><span class="number">1</span> <span class="operator">|</span> SUBPLAN SCAN <span class="operator">|</span>VIEW1<span class="operator">|</span><span class="number">11</span>       <span class="operator">|</span><span class="number">1143</span><span class="operator">|</span></span><br><span class="line"><span class="operator">|</span><span class="number">2</span> <span class="operator">|</span>  LIMIT       <span class="operator">|</span>     <span class="operator">|</span><span class="number">11</span>       <span class="operator">|</span><span class="number">1143</span><span class="operator">|</span></span><br><span class="line"><span class="operator">|</span><span class="number">3</span> <span class="operator">|</span>   TOP<span class="operator">-</span>N SORT <span class="operator">|</span>     <span class="operator">|</span><span class="number">100</span>      <span class="operator">|</span><span class="number">1141</span><span class="operator">|</span></span><br><span class="line"><span class="operator">|</span><span class="number">4</span> <span class="operator">|</span>    <span class="keyword">TABLE</span> SCAN<span class="operator">|</span>T5   <span class="operator">|</span><span class="number">729</span>      <span class="operator">|</span><span class="number">891</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span></span><br><span class="line"></span><br><span class="line">Outputs <span class="operator">&amp;</span> filters: </span><br><span class="line"><span class="comment">-------------------------------------</span></span><br><span class="line">  <span class="number">0</span> <span class="operator">-</span> output([rownum() <span class="operator">+</span> ?], [VIEW1.T5B.OWNER], [VIEW1.T5B.OBJECT_NAME], [VIEW1.T5B.SUBOBJECT_NAME], [VIEW1.T5B.OBJECT_ID], [VIEW1.T5B.DATA_OBJECT_ID], [VIEW1.T5B.OBJECT_TYPE], [VIEW1.T5B.CREATED], [VIEW1.T5B.LAST_DDL_TIME], [VIEW1.T5B.TIMESTAMP], [VIEW1.T5B.STATUS], [VIEW1.T5B.TEMPORARY], [VIEW1.T5B.GENERATED], [VIEW1.T5B.SECONDARY], [VIEW1.T5B.NAMESPACE], [VIEW1.T5B.EDITION_NAME]), <span class="keyword">filter</span>(nil)</span><br><span class="line">  <span class="number">1</span> <span class="operator">-</span> output([VIEW1.T5B.OWNER], [VIEW1.T5B.OBJECT_NAME], [VIEW1.T5B.SUBOBJECT_NAME], [VIEW1.T5B.OBJECT_ID], [VIEW1.T5B.DATA_OBJECT_ID], [VIEW1.T5B.OBJECT_TYPE], [VIEW1.T5B.CREATED], [VIEW1.T5B.LAST_DDL_TIME], [VIEW1.T5B.TIMESTAMP], [VIEW1.T5B.STATUS], [VIEW1.T5B.TEMPORARY], [VIEW1.T5B.GENERATED], [VIEW1.T5B.SECONDARY], [VIEW1.T5B.NAMESPACE], [VIEW1.T5B.EDITION_NAME]), <span class="keyword">filter</span>(nil), </span><br><span class="line">      access([VIEW1.T5B.OWNER], [VIEW1.T5B.OBJECT_NAME], [VIEW1.T5B.SUBOBJECT_NAME], [VIEW1.T5B.OBJECT_ID], [VIEW1.T5B.DATA_OBJECT_ID], [VIEW1.T5B.OBJECT_TYPE], [VIEW1.T5B.CREATED], [VIEW1.T5B.LAST_DDL_TIME], [VIEW1.T5B.TIMESTAMP], [VIEW1.T5B.STATUS], [VIEW1.T5B.TEMPORARY], [VIEW1.T5B.GENERATED], [VIEW1.T5B.SECONDARY], [VIEW1.T5B.NAMESPACE], [VIEW1.T5B.EDITION_NAME])</span><br><span class="line">  <span class="number">2</span> <span class="operator">-</span> output([T5.OWNER], [T5.OBJECT_NAME], [T5.SUBOBJECT_NAME], [T5.OBJECT_ID], [T5.DATA_OBJECT_ID], [T5.OBJECT_TYPE], [T5.CREATED], [T5.LAST_DDL_TIME], [T5.TIMESTAMP], [T5.STATUS], [T5.TEMPORARY], [T5.GENERATED], [T5.SECONDARY], [T5.NAMESPACE], [T5.EDITION_NAME]), <span class="keyword">filter</span>(nil), limit(?), <span class="keyword">offset</span>(?)</span><br><span class="line">  <span class="number">3</span> <span class="operator">-</span> output([T5.OWNER], [T5.OBJECT_NAME], [T5.SUBOBJECT_NAME], [T5.OBJECT_ID], [T5.DATA_OBJECT_ID], [T5.OBJECT_TYPE], [T5.CREATED], [T5.LAST_DDL_TIME], [T5.TIMESTAMP], [T5.STATUS], [T5.TEMPORARY], [T5.GENERATED], [T5.SECONDARY], [T5.NAMESPACE], [T5.EDITION_NAME]), <span class="keyword">filter</span>(nil), sort_keys([T5.OWNER, <span class="keyword">ASC</span>], [T5.OBJECT_NAME, <span class="keyword">ASC</span>]), topn(<span class="built_in">cast</span>(<span class="built_in">cast</span>(?, NUMBER(<span class="number">-1</span>, <span class="number">-1</span>)) <span class="operator">+</span> <span class="built_in">cast</span>(?, NUMBER(<span class="number">-1</span>, <span class="number">-1</span>)), <span class="type">BIGINT</span>(<span class="number">-1</span>, <span class="number">0</span>)))</span><br><span class="line">  <span class="number">4</span> <span class="operator">-</span> output([T5.OWNER], [T5.OBJECT_NAME], [T5.SUBOBJECT_NAME], [T5.OBJECT_ID], [T5.DATA_OBJECT_ID], [T5.OBJECT_TYPE], [T5.CREATED], [T5.LAST_DDL_TIME], [T5.TIMESTAMP], [T5.STATUS], [T5.TEMPORARY], [T5.GENERATED], [T5.SECONDARY], [T5.NAMESPACE], [T5.EDITION_NAME]), <span class="keyword">filter</span>(nil), </span><br><span class="line">      access([T5.OWNER], [T5.OBJECT_NAME], [T5.SUBOBJECT_NAME], [T5.OBJECT_ID], [T5.DATA_OBJECT_ID], [T5.OBJECT_TYPE], [T5.CREATED], [T5.LAST_DDL_TIME], [T5.TIMESTAMP], [T5.STATUS], [T5.TEMPORARY], [T5.GENERATED], [T5.SECONDARY], [T5.NAMESPACE], [T5.EDITION_NAME]), partitions(p0), </span><br><span class="line">      is_index_back<span class="operator">=</span><span class="literal">false</span>, </span><br><span class="line">      range_key([T5.__pk_increment]), <span class="keyword">range</span>(MIN ; MAX)always <span class="literal">true</span></span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>注意，OB(ORACLE)  并没有 <code>ORDER BY ORDER OF t</code> 这种用法。也不支持 <code>with ur</code> 这种脏读语法。<br>标准的 ORACLE 分页框架用法就是两层嵌套循环，最里层是先对结果集排序。这点跟 DB2 的写法不同。当表很大并且查询条件不是很好发挥索引性能的时候，这个分页查询性能往往会不好。主要是最里面的那层排序耗时。<br>特殊的业务场景下，如果要查询的字段很少，能通过索引覆盖的话，就可以提升性能。或者将这个查询改写为自关联的表连接,以提升分页的性能。</p>
<p>分页示例优化（假设 t5 表很大）：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><span class="line">EXPLAIN EXTENDED_NOADDR </span><br><span class="line"><span class="keyword">SELECT</span> l.rn, r.<span class="operator">*</span> <span class="keyword">FROM</span> (</span><br><span class="line">	<span class="keyword">SELECT</span> rownum rn,rid </span><br><span class="line">	<span class="keyword">FROM</span> (</span><br><span class="line">		<span class="keyword">SELECT</span> rowid rid</span><br><span class="line">		<span class="keyword">FROM</span> t5</span><br><span class="line">		<span class="keyword">ORDER</span> <span class="keyword">BY</span> owner,object_name</span><br><span class="line">	) 	<span class="keyword">WHERE</span> rownum <span class="operator">&lt;=</span> <span class="number">100</span></span><br><span class="line">) l <span class="keyword">JOIN</span> t5 r <span class="keyword">ON</span> l.rid<span class="operator">=</span>r.rowid  </span><br><span class="line"><span class="keyword">WHERE</span> rn <span class="operator">&gt;=</span><span class="number">90</span></span><br><span class="line"><span class="keyword">ORDER</span> <span class="keyword">BY</span> l.rn</span><br><span class="line">;</span><br><span class="line"></span><br><span class="line"><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span></span><br><span class="line"><span class="operator">|</span>ID<span class="operator">|</span>OPERATOR          <span class="operator">|</span>NAME          <span class="operator">|</span>EST. <span class="keyword">ROWS</span><span class="operator">|</span>COST<span class="operator">|</span></span><br><span class="line"><span class="comment">-----------------------------------------------------</span></span><br><span class="line"><span class="operator">|</span><span class="number">0</span> <span class="operator">|</span>SORT              <span class="operator">|</span>              <span class="operator">|</span><span class="number">358</span>      <span class="operator">|</span><span class="number">2645</span><span class="operator">|</span></span><br><span class="line"><span class="operator">|</span><span class="number">1</span> <span class="operator">|</span> <span class="keyword">MERGE</span> <span class="keyword">JOIN</span>       <span class="operator">|</span>              <span class="operator">|</span><span class="number">358</span>      <span class="operator">|</span><span class="number">1877</span><span class="operator">|</span></span><br><span class="line"><span class="operator">|</span><span class="number">2</span> <span class="operator">|</span>  <span class="keyword">TABLE</span> SCAN      <span class="operator">|</span>R(rowid_index)<span class="operator">|</span><span class="number">729</span>      <span class="operator">|</span><span class="number">1002</span><span class="operator">|</span></span><br><span class="line"><span class="operator">|</span><span class="number">3</span> <span class="operator">|</span>  SORT            <span class="operator">|</span>              <span class="operator">|</span><span class="number">50</span>       <span class="operator">|</span><span class="number">775</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span><span class="number">4</span> <span class="operator">|</span>   SUBPLAN SCAN   <span class="operator">|</span>L             <span class="operator">|</span><span class="number">50</span>       <span class="operator">|</span><span class="number">727</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span><span class="number">5</span> <span class="operator">|</span>    COUNT         <span class="operator">|</span>              <span class="operator">|</span><span class="number">100</span>      <span class="operator">|</span><span class="number">723</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span><span class="number">6</span> <span class="operator">|</span>     SUBPLAN SCAN <span class="operator">|</span>VIEW1         <span class="operator">|</span><span class="number">100</span>      <span class="operator">|</span><span class="number">722</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span><span class="number">7</span> <span class="operator">|</span>      LIMIT       <span class="operator">|</span>              <span class="operator">|</span><span class="number">100</span>      <span class="operator">|</span><span class="number">720</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span><span class="number">8</span> <span class="operator">|</span>       TOP<span class="operator">-</span>N SORT <span class="operator">|</span>              <span class="operator">|</span><span class="number">100</span>      <span class="operator">|</span><span class="number">719</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span><span class="number">9</span> <span class="operator">|</span>        <span class="keyword">TABLE</span> SCAN<span class="operator">|</span>T5            <span class="operator">|</span><span class="number">729</span>      <span class="operator">|</span><span class="number">570</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span></span><br><span class="line"></span><br><span class="line">Outputs <span class="operator">&amp;</span> filters: </span><br><span class="line"><span class="comment">-------------------------------------</span></span><br><span class="line">  <span class="number">0</span> <span class="operator">-</span> output([L.RN], [R.OWNER], [R.OBJECT_NAME], [R.SUBOBJECT_NAME], [R.OBJECT_ID], [R.DATA_OBJECT_ID], [R.OBJECT_TYPE], [R.CREATED], [R.LAST_DDL_TIME], [R.TIMESTAMP], [R.STATUS], [R.TEMPORARY], [R.GENERATED], [R.SECONDARY], [R.NAMESPACE], [R.EDITION_NAME]), <span class="keyword">filter</span>(nil), sort_keys([L.RN, <span class="keyword">ASC</span>])</span><br><span class="line">  <span class="number">1</span> <span class="operator">-</span> output([L.RN], [R.OWNER], [R.OBJECT_NAME], [R.SUBOBJECT_NAME], [R.OBJECT_ID], [R.DATA_OBJECT_ID], [R.OBJECT_TYPE], [R.CREATED], [R.LAST_DDL_TIME], [R.TIMESTAMP], [R.STATUS], [R.TEMPORARY], [R.GENERATED], [R.SECONDARY], [R.NAMESPACE], [R.EDITION_NAME]), <span class="keyword">filter</span>(nil), </span><br><span class="line">      equal_conds([L.RID <span class="operator">=</span> R.ROWID]), other_conds(nil)</span><br><span class="line">  <span class="number">2</span> <span class="operator">-</span> output([R.ROWID], [R.OWNER], [R.OBJECT_NAME], [R.SUBOBJECT_NAME], [R.OBJECT_ID], [R.DATA_OBJECT_ID], [R.OBJECT_TYPE], [R.CREATED], [R.LAST_DDL_TIME], [R.TIMESTAMP], [R.STATUS], [R.TEMPORARY], [R.GENERATED], [R.SECONDARY], [R.NAMESPACE], [R.EDITION_NAME]), <span class="keyword">filter</span>(nil), </span><br><span class="line">      access([R.__pk_increment], [R.ROWID], [R.OWNER], [R.OBJECT_NAME], [R.SUBOBJECT_NAME], [R.OBJECT_ID], [R.DATA_OBJECT_ID], [R.OBJECT_TYPE], [R.CREATED], [R.LAST_DDL_TIME], [R.TIMESTAMP], [R.STATUS], [R.TEMPORARY], [R.GENERATED], [R.SECONDARY], [R.NAMESPACE], [R.EDITION_NAME]), partitions(p0), </span><br><span class="line">      is_index_back<span class="operator">=</span><span class="literal">false</span>, </span><br><span class="line">      range_key([R.ROWID]), <span class="keyword">range</span>(MIN ; MAX)always <span class="literal">true</span></span><br><span class="line">  <span class="number">3</span> <span class="operator">-</span> output([L.RN], [L.RID]), <span class="keyword">filter</span>(nil), sort_keys([L.RID, <span class="keyword">ASC</span>])</span><br><span class="line">  <span class="number">4</span> <span class="operator">-</span> output([L.RID], [L.RN]), <span class="keyword">filter</span>([L.RN <span class="operator">&gt;=</span> <span class="number">90</span>]), </span><br><span class="line">      access([L.RID], [L.RN])</span><br><span class="line">  <span class="number">5</span> <span class="operator">-</span> output([rownum()], [VIEW1..RID]), <span class="keyword">filter</span>(nil)</span><br><span class="line">  <span class="number">6</span> <span class="operator">-</span> output([VIEW1..RID]), <span class="keyword">filter</span>(nil), </span><br><span class="line">      access([VIEW1..RID])</span><br><span class="line">  <span class="number">7</span> <span class="operator">-</span> output([T5.ROWID]), <span class="keyword">filter</span>(nil), limit(?), <span class="keyword">offset</span>(nil)</span><br><span class="line">  <span class="number">8</span> <span class="operator">-</span> output([T5.ROWID]), <span class="keyword">filter</span>(nil), sort_keys([T5.OWNER, <span class="keyword">ASC</span>], [T5.OBJECT_NAME, <span class="keyword">ASC</span>]), topn(?)</span><br><span class="line">  <span class="number">9</span> <span class="operator">-</span> output([T5.ROWID], [T5.OWNER], [T5.OBJECT_NAME]), <span class="keyword">filter</span>(nil), </span><br><span class="line">      access([T5.__pk_increment], [T5.ROWID], [T5.OWNER], [T5.OBJECT_NAME]), partitions(p0), </span><br><span class="line">      is_index_back<span class="operator">=</span><span class="literal">false</span>, </span><br><span class="line">      range_key([T5.__pk_increment]), <span class="keyword">range</span>(MIN ; MAX)always <span class="literal">true</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>如果 DB2 的 <code>row_number</code> 函数不仅仅是分页，还有分组功能，那就转换为 ORACLE 对应的  <code>row_number</code> 函数用法。</p>
<h3 id="FETCH-FIRST-N-ROWS"><a href="#FETCH-FIRST-N-ROWS" class="headerlink" title="FETCH FIRST N ROWS"></a><code>FETCH FIRST N ROWS</code></h3><p>在 OB 3.1 版本之后，也支持 <code>FETCH FIRST N ROWS</code> 。3.1 版本之前，就按上面分页方法。</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line">explain extended_noaddr </span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span></span><br><span class="line"><span class="keyword">FROM</span> (</span><br><span class="line">	<span class="keyword">SELECT</span> <span class="built_in">row_number</span>() <span class="keyword">OVER</span> (<span class="keyword">ORDER</span> <span class="keyword">BY</span> owner,object_name) rn , t5.<span class="operator">*</span> <span class="keyword">FROM</span> t5 <span class="keyword">ORDER</span> <span class="keyword">BY</span> owner, object_name <span class="keyword">FETCH</span> <span class="keyword">FIRST</span> <span class="number">100</span> <span class="keyword">ROWS</span> <span class="keyword">ONLY</span></span><br><span class="line">) t5b </span><br><span class="line"><span class="keyword">WHERE</span> rn <span class="operator">&gt;=</span><span class="number">90</span>;</span><br><span class="line"></span><br><span class="line"><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span></span><br><span class="line"><span class="operator">|</span>ID<span class="operator">|</span>OPERATOR         <span class="operator">|</span>NAME<span class="operator">|</span>EST. <span class="keyword">ROWS</span><span class="operator">|</span>COST<span class="operator">|</span></span><br><span class="line"><span class="comment">------------------------------------------</span></span><br><span class="line"><span class="operator">|</span><span class="number">0</span> <span class="operator">|</span>SUBPLAN SCAN     <span class="operator">|</span>T5B <span class="operator">|</span><span class="number">50</span>       <span class="operator">|</span><span class="number">2749</span><span class="operator">|</span></span><br><span class="line"><span class="operator">|</span><span class="number">1</span> <span class="operator">|</span> LIMIT           <span class="operator">|</span>    <span class="operator">|</span><span class="number">100</span>      <span class="operator">|</span><span class="number">2746</span><span class="operator">|</span></span><br><span class="line"><span class="operator">|</span><span class="number">2</span> <span class="operator">|</span>  <span class="keyword">WINDOW</span> <span class="keyword">FUNCTION</span><span class="operator">|</span>    <span class="operator">|</span><span class="number">100</span>      <span class="operator">|</span><span class="number">2744</span><span class="operator">|</span></span><br><span class="line"><span class="operator">|</span><span class="number">3</span> <span class="operator">|</span>   SORT          <span class="operator">|</span>    <span class="operator">|</span><span class="number">729</span>      <span class="operator">|</span><span class="number">2357</span><span class="operator">|</span></span><br><span class="line"><span class="operator">|</span><span class="number">4</span> <span class="operator">|</span>    <span class="keyword">TABLE</span> SCAN   <span class="operator">|</span>T5  <span class="operator">|</span><span class="number">729</span>      <span class="operator">|</span><span class="number">891</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span></span><br><span class="line"></span><br><span class="line">Outputs <span class="operator">&amp;</span> filters: </span><br><span class="line"><span class="comment">-------------------------------------</span></span><br><span class="line">  <span class="number">0</span> <span class="operator">-</span> output([T5B.RN], [T5B.OWNER], [T5B.OBJECT_NAME], [T5B.SUBOBJECT_NAME], [T5B.OBJECT_ID], [T5B.DATA_OBJECT_ID], [T5B.OBJECT_TYPE], [T5B.CREATED], [T5B.LAST_DDL_TIME], [T5B.TIMESTAMP], [T5B.STATUS], [T5B.TEMPORARY], [T5B.GENERATED], [T5B.SECONDARY], [T5B.NAMESPACE], [T5B.EDITION_NAME]), <span class="keyword">filter</span>([T5B.RN <span class="operator">&gt;=</span> <span class="number">90</span>]), </span><br><span class="line">      access([T5B.RN], [T5B.OWNER], [T5B.OBJECT_NAME], [T5B.SUBOBJECT_NAME], [T5B.OBJECT_ID], [T5B.DATA_OBJECT_ID], [T5B.OBJECT_TYPE], [T5B.CREATED], [T5B.LAST_DDL_TIME], [T5B.TIMESTAMP], [T5B.STATUS], [T5B.TEMPORARY], [T5B.GENERATED], [T5B.SECONDARY], [T5B.NAMESPACE], [T5B.EDITION_NAME])</span><br><span class="line">  <span class="number">1</span> <span class="operator">-</span> output([T_WIN_FUN_ROW_NUMBER()], [T5.OWNER], [T5.OBJECT_NAME], [T5.SUBOBJECT_NAME], [T5.OBJECT_ID], [T5.DATA_OBJECT_ID], [T5.OBJECT_TYPE], [T5.CREATED], [T5.LAST_DDL_TIME], [T5.TIMESTAMP], [T5.STATUS], [T5.TEMPORARY], [T5.GENERATED], [T5.SECONDARY], [T5.NAMESPACE], [T5.EDITION_NAME]), <span class="keyword">filter</span>(nil), limit(?), <span class="keyword">offset</span>(nil)</span><br><span class="line">  <span class="number">2</span> <span class="operator">-</span> output([T_WIN_FUN_ROW_NUMBER()], [T5.OWNER], [T5.OBJECT_NAME], [T5.SUBOBJECT_NAME], [T5.OBJECT_ID], [T5.DATA_OBJECT_ID], [T5.OBJECT_TYPE], [T5.CREATED], [T5.LAST_DDL_TIME], [T5.TIMESTAMP], [T5.STATUS], [T5.TEMPORARY], [T5.GENERATED], [T5.SECONDARY], [T5.NAMESPACE], [T5.EDITION_NAME]), <span class="keyword">filter</span>(nil), </span><br><span class="line">      win_expr(T_WIN_FUN_ROW_NUMBER()), partition_by(nil), order_by([T5.OWNER, <span class="keyword">ASC</span>], [T5.OBJECT_NAME, <span class="keyword">ASC</span>]), window_type(<span class="keyword">RANGE</span>), <span class="built_in">upper</span>(UNBOUNDED PRECEDING), <span class="built_in">lower</span>(UNBOUNDED FOLLOWING)</span><br><span class="line">  <span class="number">3</span> <span class="operator">-</span> output([T5.OWNER], [T5.OBJECT_NAME], [T5.SUBOBJECT_NAME], [T5.OBJECT_ID], [T5.DATA_OBJECT_ID], [T5.OBJECT_TYPE], [T5.CREATED], [T5.LAST_DDL_TIME], [T5.TIMESTAMP], [T5.STATUS], [T5.TEMPORARY], [T5.GENERATED], [T5.SECONDARY], [T5.NAMESPACE], [T5.EDITION_NAME]), <span class="keyword">filter</span>(nil), sort_keys([T5.OWNER, <span class="keyword">ASC</span>], [T5.OBJECT_NAME, <span class="keyword">ASC</span>])</span><br><span class="line">  <span class="number">4</span> <span class="operator">-</span> output([T5.OWNER], [T5.OBJECT_NAME], [T5.SUBOBJECT_NAME], [T5.OBJECT_ID], [T5.DATA_OBJECT_ID], [T5.OBJECT_TYPE], [T5.CREATED], [T5.LAST_DDL_TIME], [T5.TIMESTAMP], [T5.STATUS], [T5.TEMPORARY], [T5.GENERATED], [T5.SECONDARY], [T5.NAMESPACE], [T5.EDITION_NAME]), <span class="keyword">filter</span>(nil), </span><br><span class="line">      access([T5.OWNER], [T5.OBJECT_NAME], [T5.SUBOBJECT_NAME], [T5.OBJECT_ID], [T5.DATA_OBJECT_ID], [T5.OBJECT_TYPE], [T5.CREATED], [T5.LAST_DDL_TIME], [T5.TIMESTAMP], [T5.STATUS], [T5.TEMPORARY], [T5.GENERATED], [T5.SECONDARY], [T5.NAMESPACE], [T5.EDITION_NAME]), partitions(p0), </span><br><span class="line">      is_index_back<span class="operator">=</span><span class="literal">false</span>, </span><br><span class="line">      range_key([T5.__pk_increment]), <span class="keyword">range</span>(MIN ; MAX)always <span class="literal">true</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h3 id="列名重复问题"><a href="#列名重复问题" class="headerlink" title="列名重复问题"></a>列名重复问题</h3><p>DB2 的查询结果集可以接受有重复的列名（投影列），但是 OB(ORACLE) 不行。</p>
<p>DB2 示例：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">db2 <span class="operator">=</span><span class="operator">&gt;</span> <span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> (<span class="keyword">SELECT</span> id,c1,c1 <span class="keyword">FROM</span> t3);</span><br><span class="line"></span><br><span class="line">ID                   C1                                                 C1</span><br><span class="line"><span class="comment">-------------------- -------------------------------------------------- --------------------------------------------------</span></span><br><span class="line">                   <span class="number">1</span></span><br><span class="line">                   <span class="number">2</span></span><br><span class="line"></span><br><span class="line">  <span class="number">2</span> record(s) selected.</span><br><span class="line"></span><br><span class="line">db2 <span class="operator">=</span><span class="operator">&gt;</span></span><br></pre></td></tr></table></figure>

<p>ORACLE 示例：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">obclient<span class="operator">&gt;</span> <span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> (<span class="keyword">SELECT</span> id,c1,c1  <span class="keyword">FROM</span> t3);</span><br><span class="line">ORA<span class="number">-00918</span>: <span class="keyword">column</span> <span class="string">&#x27;C1&#x27;</span> <span class="keyword">in</span> field list ambiguously defined</span><br><span class="line">obclient<span class="operator">&gt;</span></span><br></pre></td></tr></table></figure>

<h3 id="表别名问题"><a href="#表别名问题" class="headerlink" title="表别名问题"></a>表别名问题</h3><p>DB2 表别名语法用 <code>AS</code> 关键字，是可选的。但是 OB(ORACLE) 表别名不支持 <code>AS</code> 关键字。</p>
<ul>
<li><p>DB2 示例：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">db2 <span class="operator">=</span><span class="operator">&gt;</span> <span class="keyword">select</span> id , c1 <span class="keyword">as</span> c1_new <span class="keyword">from</span> t4  <span class="keyword">as</span> t4_new ;</span><br><span class="line"></span><br><span class="line">ID                   C1_NEW</span><br><span class="line"><span class="comment">-------------------- --------------------------------------------------</span></span><br><span class="line">                   <span class="number">1</span> a</span><br><span class="line"></span><br><span class="line">  <span class="number">1</span> record(s) selected.</span><br><span class="line"></span><br><span class="line">db2 <span class="operator">=</span><span class="operator">&gt;</span> <span class="keyword">select</span> id , c1 c1_new <span class="keyword">from</span> t4  t4_new ;</span><br><span class="line"></span><br><span class="line">ID                   C1_NEW</span><br><span class="line"><span class="comment">-------------------- --------------------------------------------------</span></span><br><span class="line">                   <span class="number">1</span> a</span><br><span class="line"></span><br><span class="line">  <span class="number">1</span> record(s) selected.</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<ul>
<li>OB(ORACLE) 示例：</li>
</ul>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">obclient<span class="operator">&gt;</span> <span class="keyword">select</span> id , c1 <span class="keyword">as</span> c1_new <span class="keyword">from</span> t4  <span class="keyword">as</span> t4_new ;</span><br><span class="line">ORA<span class="number">-00900</span>: You have an error <span class="keyword">in</span> your <span class="keyword">SQL</span> syntax; <span class="keyword">check</span> the manual that corresponds <span class="keyword">to</span> your OceanBase version <span class="keyword">for</span> the <span class="keyword">right</span> syntax <span class="keyword">to</span> use near <span class="string">&#x27;t4_new&#x27;</span> <span class="keyword">at</span> line <span class="number">1</span></span><br><span class="line">obclient<span class="operator">&gt;</span> <span class="keyword">select</span> id , c1 <span class="keyword">as</span> c1_new <span class="keyword">from</span> t4  t4_new ;</span><br><span class="line"><span class="operator">+</span><span class="comment">----+--------+</span></span><br><span class="line"><span class="operator">|</span> ID <span class="operator">|</span> C1_NEW <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">----+--------+</span></span><br><span class="line"><span class="operator">|</span>  <span class="number">2</span> <span class="operator">|</span> a      <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">----+--------+</span></span><br><span class="line"><span class="number">1</span> <span class="type">row</span> <span class="keyword">in</span> <span class="keyword">set</span> (<span class="number">0.00</span> sec)</span><br><span class="line">obclient<span class="operator">&gt;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure></li>
</ul>
<h2 id="DB2-的-ORACLE-兼容模式"><a href="#DB2-的-ORACLE-兼容模式" class="headerlink" title="DB2 的 ORACLE 兼容模式"></a>DB2 的 ORACLE 兼容模式</h2><p>为了减少 DB2 和 ORACLE 的不兼容逻辑，或者说 IBM 当初为了减少 ORALCE 应用迁移到 DB2 上的修改成本，DB2 可以开启 ORACLE 兼容模式。这个需要在创建数据库的时候就指定，后期不能修改。适合以 OB(ORACLE) 为主，DB2 为异构备的方案。</p>
<ul>
<li>DB2 数据库开启 ORACLE 兼容模式方法：</li>
</ul>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[db2inst1@08935f5bff4f ~]$ db2set -all[i] DB2COMM=TCPIP[g] DB2SYSTEM=08935f5bff4f[db2inst1@08935f5bff4f ~]$ db2set DB2_COMPATIBILITY_VECTOR=ORA[db2inst1@08935f5bff4f ~]$ db2set -all[i] DB2_COMPATIBILITY_VECTOR=ORA[i] DB2COMM=TCPIP[g] DB2SYSTEM=08935f5bff4f[db2inst1@08935f5bff4f ~]$ db2stop01/28/2021 03:03:23 0 0 SQL1064N DB2STOP processing was successful.SQL1064N DB2STOP processing was successful.[db2inst1@08935f5bff4f ~]$ db2start01/28/2021 03:05:13 0 0 SQL1063N DB2START processing was successful.SQL1063N DB2START processing was successful.[db2inst1@08935f5bff4f ~]$[db2inst1@59f37c64eddd ~]$ db2 create db db2ora using codeset utf-8 territory USDB20000I The CREATE DATABASE <span class="built_in">command</span> completed successfully.[db2inst1@59f37c64eddd ~]$</span><br></pre></td></tr></table></figure>

<ul>
<li>DB2 建表示例 </li>
</ul>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">[db2inst1<span class="variable">@a32408ac626d</span> <span class="operator">~</span>]$ db2 &quot;DROP TABLE T10;&quot;</span><br><span class="line">DB20000I  The <span class="keyword">SQL</span> command completed successfully.</span><br><span class="line">[db2inst1<span class="variable">@a32408ac626d</span> <span class="operator">~</span>]$ db2 &quot;CREATE TABLE T10 (</span><br><span class="line">&gt; ID BIGINT NOT NULL GENERATED BY DEFAULT AS IDENTITY (MAXVALUE 9223372036854775807),</span><br><span class="line">&gt; C1 NUMBER NOT NULL,</span><br><span class="line">&gt; C2 VARCHAR2(50) NOT NULL,</span><br><span class="line">&gt; C3 NVARCHAR2(50) NOT NULL,</span><br><span class="line">&gt; C4 DATE NOT NULL DEFAULT SYSDATE,</span><br><span class="line">&gt; C5 TIMESTAMP NOT NULL DEFAULT CURRENT_TIMESTAMP</span><br><span class="line">&gt; );&quot;</span><br><span class="line">DB20000I  The <span class="keyword">SQL</span> command completed successfully.</span><br><span class="line">[db2inst1<span class="variable">@a32408ac626d</span> <span class="operator">~</span>]$</span><br><span class="line">[db2inst1<span class="variable">@a32408ac626d</span> <span class="operator">~</span>]$ db2 &quot;INSERT INTO t10(c1,c2,c3) values(1,&#x27;a&#x27;,&#x27;A&#x27;);&quot;</span><br><span class="line">DB20000I  The <span class="keyword">SQL</span> command completed successfully.</span><br><span class="line">[db2inst1<span class="variable">@a32408ac626d</span> <span class="operator">~</span>]$</span><br><span class="line">[db2inst1<span class="variable">@a32408ac626d</span> <span class="operator">~</span>]$ db2 &quot;INSERT INTO t10(c1,c2,c3) values(2,&#x27;b&#x27;,&#x27;&#x27;);&quot;</span><br><span class="line">DB21034E  The command was processed <span class="keyword">as</span> an <span class="keyword">SQL</span> statement because it was <span class="keyword">not</span> a</span><br><span class="line">valid Command Line Processor command.  During <span class="keyword">SQL</span> processing it returned:</span><br><span class="line">SQL0407N  Assignment <span class="keyword">of</span> a <span class="keyword">NULL</span> <span class="keyword">value</span> <span class="keyword">to</span> a <span class="keyword">NOT</span> <span class="keyword">NULL</span> <span class="keyword">column</span> &quot;TBSPACEID=2,</span><br><span class="line">TABLEID=523, COLNO=3&quot; <span class="keyword">is</span> <span class="keyword">not</span> allowed.  <span class="keyword">SQLSTATE</span><span class="operator">=</span><span class="number">23502</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>可见，当开启 ORACLE 兼容模式后，支持 ORACLE 的列类型，并且 <code>NULL</code> 跟空值也等同对待了。</p>
<p>查看一下表结构,可见在 DB2 内部，表的列还是以 DB2 的原生类型存储。</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line">[db2inst1<span class="variable">@a32408ac626d</span> <span class="operator">~</span>]$ db2look <span class="operator">-</span>d testdb <span class="operator">-</span>e <span class="operator">-</span>t T10</span><br><span class="line"><span class="comment">-- No userid was specified, db2look tries to use Environment variable USER</span></span><br><span class="line"><span class="comment">-- USER is: DB2INST1</span></span><br><span class="line"><span class="comment">-- The db2look utility will consider only the specified tables</span></span><br><span class="line"><span class="comment">-- Creating DDL for table(s)</span></span><br><span class="line"><span class="comment">-- This CLP file was created using DB2LOOK Version &quot;11.5&quot;</span></span><br><span class="line"><span class="comment">-- Timestamp: Sat Aug 14 09:52:21 2021</span></span><br><span class="line"><span class="comment">-- Database Name: TESTDB</span></span><br><span class="line"><span class="comment">-- Database Manager Version: DB2/LINUXX8664 Version 11.5.6.0</span></span><br><span class="line"><span class="comment">-- Database Codepage: 1208</span></span><br><span class="line"><span class="comment">-- Database Collating Sequence is: IDENTITY</span></span><br><span class="line"><span class="comment">-- Alternate collating sequence(alt_collate): null</span></span><br><span class="line"><span class="comment">-- varchar2 compatibility(varchar2_compat): ON</span></span><br><span class="line"></span><br><span class="line"><span class="comment">-- Binding package automatically ...</span></span><br><span class="line"><span class="comment">-- Bind is successful</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">CONNECT</span> <span class="keyword">TO</span> TESTDB;</span><br><span class="line"></span><br><span class="line"><span class="comment">------------------------------------------------</span></span><br><span class="line"><span class="comment">-- DDL Statements for Table &quot;TPCC&quot;.&quot;T10&quot;</span></span><br><span class="line"><span class="comment">------------------------------------------------</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> &quot;TPCC&quot;.&quot;T10&quot;  (</span><br><span class="line">                  &quot;ID&quot; <span class="type">BIGINT</span> <span class="keyword">NOT</span> <span class="keyword">NULL</span> GENERATED <span class="keyword">BY</span> <span class="keyword">DEFAULT</span> <span class="keyword">AS</span> <span class="keyword">IDENTITY</span> (</span><br><span class="line">                    <span class="keyword">START</span> <span class="keyword">WITH</span> <span class="operator">+</span><span class="number">1</span></span><br><span class="line">                    INCREMENT <span class="keyword">BY</span> <span class="operator">+</span><span class="number">1</span></span><br><span class="line">                    MINVALUE <span class="operator">+</span><span class="number">1</span></span><br><span class="line">                    MAXVALUE <span class="operator">+</span><span class="number">9223372036854775807</span></span><br><span class="line">                    <span class="keyword">NO</span> <span class="keyword">CYCLE</span></span><br><span class="line">                    CACHE <span class="number">20</span></span><br><span class="line">                    <span class="keyword">NO</span> <span class="keyword">ORDER</span> ) ,</span><br><span class="line">                  &quot;C1&quot; <span class="type">DECFLOAT</span>(<span class="number">16</span>) <span class="keyword">NOT</span> <span class="keyword">NULL</span> ,</span><br><span class="line">                  &quot;C2&quot; <span class="type">VARCHAR</span>(<span class="number">50</span> OCTETS) <span class="keyword">NOT</span> <span class="keyword">NULL</span> ,</span><br><span class="line">                  &quot;C3&quot; <span class="type">VARCHAR</span>(<span class="number">50</span> CODEUNITS32) <span class="keyword">NOT</span> <span class="keyword">NULL</span> ,</span><br><span class="line">                  &quot;C4&quot; <span class="type">TIMESTAMP</span>(<span class="number">0</span>) <span class="keyword">NOT</span> <span class="keyword">NULL</span> <span class="keyword">WITH</span> <span class="keyword">DEFAULT</span> &quot;SYSIBM&quot;.&quot;TIMESTAMP&quot;(<span class="keyword">CURRENT</span> <span class="type">TIMESTAMP</span>) ,</span><br><span class="line">                  &quot;C5&quot; <span class="type">TIMESTAMP</span> <span class="keyword">NOT</span> <span class="keyword">NULL</span> <span class="keyword">WITH</span> <span class="keyword">DEFAULT</span> <span class="keyword">CURRENT</span> <span class="type">TIMESTAMP</span> )</span><br><span class="line">                 <span class="keyword">IN</span> &quot;USERSPACE1&quot;</span><br><span class="line">                 ORGANIZE <span class="keyword">BY</span> <span class="type">ROW</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">ALTER</span> <span class="keyword">TABLE</span> &quot;TPCC&quot;.&quot;T10&quot; <span class="keyword">ALTER</span> <span class="keyword">COLUMN</span> &quot;ID&quot; RESTART <span class="keyword">WITH</span> <span class="number">21</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">COMMIT</span> WORK;</span><br><span class="line"></span><br><span class="line"><span class="keyword">CONNECT</span> RESET;</span><br><span class="line"></span><br><span class="line">TERMINATE;</span><br><span class="line"></span><br><span class="line">[db2inst1<span class="variable">@a32408ac626d</span> <span class="operator">~</span>]$</span><br></pre></td></tr></table></figure>

<p>注意，如果如果涉及到国家字符集，则按DB2的 Unicode 规则保存，每个汉字是 4 个字节。</p>
<h2 id="DB2-和-OB-ORACLE-的异构数据同步"><a href="#DB2-和-OB-ORACLE-的异构数据同步" class="headerlink" title="DB2 和 OB(ORACLE) 的异构数据同步"></a>DB2 和 OB(ORACLE) 的异构数据同步</h2><p>DB2 和 ORACLE 语法的客观差异决定 DB2 到 OB(ORACLE) 的同步或者并轨运行不会是一件轻松的事情。实际项目有的是业务自己同步，有的是靠产品同步。<br>如果是产品做异构同步，业务需要做一些妥协。比如说遵守特定的数据库表结构设计规范、SQL 规范等等。传统的数据库同步产品 OGG 、DSG 等做异构同步也是同样的经验。<br>就 DB2 和 OB(ORACLE)之间的实时同步，可以使用 OB 官方数据同步产品（OMS）或者 OB 合作伙伴产品（DSG）。如果是离线同步，可以使用 Alibaba 开源的 DATAX 产品（ DATAX 的 OB 插件源码也已经随着 OB 社区版一起开源）。</p>
<p>OMS 的 DB2 同步功能包括：</p>
<ul>
<li>DB2 和 OB(ORACLE) 彼此的全量表结构同步。</li>
<li>DB2 和 OB(ORACLE) 彼此的全量数据同步。</li>
<li>DB2 和 OB(ORACLE) 彼此的增量数据同步。</li>
<li>DB2 和 OB(ORACLE) 彼此的增量表结构同步。</li>
</ul>
<p>注意，这里说的是具备双向同步的能力，但是只激活单向的同步链路。</p>
<p>非表结构对象在技术上存在一些客观的技术困难，需要人为分析再手动同步：</p>
<ul>
<li>序列的同步。目标端再激活之前，序列的值需要推高。在 OB(ORACLE) 里目前推高序列的方法是重建序列。</li>
<li>同义词的同步。同义词链接的对象可能是其他 用户或SCHEMA 下的对象，这有个依赖问题，需要分析后手动同步。</li>
<li>存储过程的同步。DB2 和 OB(ORACLE) 存储过程语法差异非常大，很多用法都要翻译为兼容性的实现。目前还需要手动做。</li>
</ul>
<h2 id="其他参考"><a href="#其他参考" class="headerlink" title="其他参考"></a>其他参考</h2><p>单纯的看 DB2 到 OB(ORACLE) 的异构同步，是一件困难麻烦多收益少的事情。还需要其他角度来看这个事情。<br>首先是可以降低对 IBM 小机和存储等高端硬件的依赖，相应的数据库运维技术门槛也降低。 稳定性方面 OB 通过多副本（3 副本或 5 副本）以及容灾集群来提高整体的可靠性。<br>第二是数据库架构从集中式转向分布式，业务的架构也相应的转向分布式架构，两条腿走路跑的快。虽然目前看复杂的 SQL，单条语句性能 OB 可能不如小机上的 DB2 跑的快，但是 OB 的并发处理能力强。当并发上去后（如50、100等等），复杂 SQL 在 OB 上的平均延时水平很可能比 DB2 低很多，吞吐能力会更高。<br>第三是成熟的开发商（ISV）的应用本身都适配过 DB2、ORACLE 和 MySQL。所以在核心业务表结构设计上对特定数据库依赖很少，尽可能的取各个数据库能力的交集。这样的业务做 DB2 到 OB(ORACLE) 的迁移，困难还会少很多。</p>
<h2 id="附录"><a href="#附录" class="headerlink" title="附录"></a>附录</h2><h3 id="DB2-DOCKER-环境搭建"><a href="#DB2-DOCKER-环境搭建" class="headerlink" title="DB2 DOCKER 环境搭建"></a>DB2 DOCKER 环境搭建</h3><ul>
<li>下载 db2 镜像</li>
</ul>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">docker pull ibmcom/db2</span><br><span class="line"></span><br><span class="line">docker images |grep db2</span><br><span class="line">REPOSITORY                                            TAG                     IMAGE ID            CREATED             SIZE</span><br><span class="line">ibmcom/db2                                            latest                  a6a5ee354fb1        7 weeks ago         2.95GB</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<ul>
<li>起 db2 容器（不兼容ORACLE）</li>
</ul>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># docker volume create db2-11.5</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># docker run -itd --name db2_11.5 --privileged=true -p 50000:50000 \</span></span><br><span class="line">        -e LICENSE=accept \</span><br><span class="line">        -e DB2INST1_PASSWORD=db2inst1 \</span><br><span class="line">        -e DBNAME=testdb \</span><br><span class="line">        -e DBPORT=50000 \</span><br><span class="line">        -e TSPORT=55000 \</span><br><span class="line">        -e ENABLE_ORACLE_COMPATIBILITY=<span class="literal">true</span> \</span><br><span class="line">        -v db2-11.5:/database ibmcom/db2</span><br><span class="line"></span><br><span class="line">-- 等 5 分钟，db2 容器初始化完毕</span><br><span class="line"><span class="comment"># docker logs db2_11.5</span></span><br><span class="line"></span><br><span class="line">-- 进入 db2 容器</span><br><span class="line"><span class="comment"># docker exec -it  db2-11.5 bash</span></span><br><span class="line"><span class="comment"># su - db2inst1</span></span><br><span class="line"></span><br><span class="line">-- 连接数据库，查看表信息</span><br><span class="line">$ db2 connect to testdb</span><br><span class="line">$ db2 <span class="built_in">set</span> current schema tpcc</span><br><span class="line">$ db2 list tables <span class="keyword">for</span> schema tpcc</span><br><span class="line">$ db2 describe table t10</span><br><span class="line"></span><br><span class="line">-- 查看 db2 归档日志设置，增量同步需要开启归档</span><br><span class="line">$ db2 get db cfg <span class="keyword">for</span> testdb |grep -i <span class="built_in">log</span></span><br><span class="line"></span><br><span class="line">-- 查看/修改 db2 默认监听端口</span><br><span class="line">$ db2 get dbm cfg |grep -i tcp/ip</span><br><span class="line"> TCP/IP Service name                          (SVCENAME) = db2c_db2inst1</span><br><span class="line"> </span><br><span class="line">$ cat /etc/services |grep db2c_db2inst1</span><br><span class="line">db2c_db2inst1      50000/tcp</span><br><span class="line">db2c_db2inst1_ssl  50001/tcp</span><br><span class="line"></span><br><span class="line">--修改 /etc/services 端口后，重启 db2</span><br><span class="line">$ db2stop</span><br><span class="line">$ db2start</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h3 id="DATAX-FOR-OB-同步任务文件示例"><a href="#DATAX-FOR-OB-同步任务文件示例" class="headerlink" title="DATAX FOR OB 同步任务文件示例"></a>DATAX FOR OB 同步任务文件示例</h3><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    <span class="attr">&quot;job&quot;</span>: &#123;</span><br><span class="line">        <span class="attr">&quot;setting&quot;</span>: &#123;</span><br><span class="line">            <span class="attr">&quot;speed&quot;</span>: &#123;</span><br><span class="line">                <span class="attr">&quot;channel&quot;</span>: <span class="number">8</span>,</span><br><span class="line">            &#125;,</span><br><span class="line">            <span class="attr">&quot;errorLimit&quot;</span>: &#123;</span><br><span class="line">                <span class="attr">&quot;record&quot;</span>: <span class="number">10000</span></span><br><span class="line">            &#125;</span><br><span class="line">        &#125;,</span><br><span class="line">        <span class="attr">&quot;content&quot;</span>: [</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="attr">&quot;reader&quot;</span>: &#123;</span><br><span class="line">                    <span class="attr">&quot;name&quot;</span>: <span class="string">&quot;db2reader&quot;</span>,</span><br><span class="line">                    <span class="attr">&quot;parameter&quot;</span>: &#123;</span><br><span class="line">                        <span class="attr">&quot;username&quot;</span>: <span class="string">&quot;db2inst1&quot;</span>,</span><br><span class="line">                        <span class="attr">&quot;password&quot;</span>: <span class="string">&quot;******&quot;</span>,</span><br><span class="line">                        <span class="attr">&quot;splitPK&quot;</span>:<span class="string">&quot;ID&quot;</span>,</span><br><span class="line">                        <span class="attr">&quot;column&quot;</span>: [<span class="string">&quot;id&quot;</span>, <span class="string">&quot;c1&quot;</span>, <span class="string">&quot;c2&quot;</span>] ,</span><br><span class="line">                        <span class="attr">&quot;connection&quot;</span>: [</span><br><span class="line">                            &#123;</span><br><span class="line">                                <span class="attr">&quot;jdbcUrl&quot;</span>: [</span><br><span class="line">                                    <span class="string">&quot;jdbc:db2://127.0.0.1:50000/testdb:currentSchema=JXXD;&quot;</span></span><br><span class="line">                                ],</span><br><span class="line">                                <span class="attr">&quot;table&quot;</span>: [</span><br><span class="line">                                    <span class="string">&quot;datax_test&quot;</span></span><br><span class="line">                                ]</span><br><span class="line">                            &#125;</span><br><span class="line">                        ]</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;,</span><br><span class="line">                <span class="attr">&quot;writer&quot;</span>: &#123;</span><br><span class="line">                    <span class="attr">&quot;name&quot;</span>: <span class="string">&quot;oceanbasev10writer&quot;</span>,</span><br><span class="line">                    <span class="attr">&quot;parameter&quot;</span>: &#123;</span><br><span class="line">                        <span class="attr">&quot;writeMode&quot;</span>: <span class="string">&quot;insert&quot;</span>,</span><br><span class="line">                        <span class="attr">&quot;username&quot;</span>: <span class="string">&quot;tpcc&quot;</span>,</span><br><span class="line">                        <span class="attr">&quot;password&quot;</span>: <span class="string">&quot;******&quot;</span>,</span><br><span class="line">                        <span class="attr">&quot;column&quot;</span>: [<span class="string">&quot;id&quot;</span>, <span class="string">&quot;c1&quot;</span>, <span class="string">&quot;c2&quot;</span>] ,</span><br><span class="line">                        <span class="attr">&quot;connection&quot;</span>: [</span><br><span class="line">                            &#123;</span><br><span class="line">                                <span class="attr">&quot;jdbcUrl&quot;</span>: <span class="string">&quot;||_dsc_ob10_dsc_||obdemo:oboracle||_dsc_ob10_dsc_||jdbc:oceanbase://127.0.0.1:2883/tpcc&quot;</span>,</span><br><span class="line">                                <span class="attr">&quot;table&quot;</span>: [</span><br><span class="line">                                    <span class="string">&quot;datax_test&quot;</span></span><br><span class="line">                                ]</span><br><span class="line">                            &#125;</span><br><span class="line">                        ]</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        ]</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>运行方法：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">cd</span> /home/admin/datax3 &amp;&amp; bin/datax.py job/datax_test.json</span><br></pre></td></tr></table></figure>


    </div>

    
    
    

    <footer class="post-footer">
          <div class="followme">
  <span>Welcome to my other publishing channels</span>

  <div class="social-list">

      <div class="social-item">
        <a target="_blank" class="social-link" href="/images/0.5.jpg">
          <span class="icon">
            <i class="fab fa-weixin"></i>
          </span>

          <span class="label">WeChat</span>
        </a>
      </div>
  </div>
</div>

          <div class="post-tags">
              <a href="/tags/DB2/" rel="tag"># DB2</a>
              <a href="/tags/OCEANBASE/" rel="tag"># OCEANBASE</a>
          </div>

        

          <div class="post-nav">
            <div class="post-nav-item">
                <a href="/2021/08/30/%E4%B8%89%E6%AD%A5%E4%BD%93%E9%AA%8C-OceanBase-%E7%A4%BE%E5%8C%BA%E7%89%88/" rel="prev" title="三步体验 OceanBase 社区版">
                  <i class="fa fa-chevron-left"></i> 三步体验 OceanBase 社区版
                </a>
            </div>
            <div class="post-nav-item">
                <a href="/2021/08/30/%E5%A6%82%E4%BD%95%E4%BD%BF%E7%94%A8DataX%E5%9C%A8OB%E5%92%8C%E4%BC%A0%E7%BB%9F%E6%95%B0%E6%8D%AE%E5%BA%93%E4%B9%8B%E9%97%B4%E5%90%8C%E6%AD%A5%E6%95%B0%E6%8D%AE/" rel="next" title="如何使用DataX在OB和传统数据库之间同步数据">
                  如何使用DataX在OB和传统数据库之间同步数据 <i class="fa fa-chevron-right"></i>
                </a>
            </div>
          </div>
    </footer>
  </article>
</div>






</div>
  </main>

  <footer class="footer">
    <div class="footer-inner">


<div class="copyright">
  &copy; 
  <span itemprop="copyrightYear">2021</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">obpilot</span>
</div>
<div class="wordcount">
  <span class="post-meta-item">
    <span class="post-meta-item-icon">
      <i class="fa fa-chart-line"></i>
    </span>
    <span title="Symbols count total">68k</span>
  </span>
  <span class="post-meta-item">
    <span class="post-meta-item-icon">
      <i class="fa fa-coffee"></i>
    </span>
    <span title="Reading time total">1:02</span>
  </span>
</div>
<div class="busuanzi-count">
    <span class="post-meta-item" id="busuanzi_container_site_uv">
      <span class="post-meta-item-icon">
        <i class="fa fa-user"></i>
      </span>
      <span class="site-uv" title="Total Visitors">
        <span id="busuanzi_value_site_uv"></span>
      </span>
    </span>
    <span class="post-meta-item" id="busuanzi_container_site_pv">
      <span class="post-meta-item-icon">
        <i class="fa fa-eye"></i>
      </span>
      <span class="site-pv" title="Total Views">
        <span id="busuanzi_value_site_pv"></span>
      </span>
    </span>
</div>
  <div class="powered-by">Powered by <a href="https://hexo.io/" rel="noopener" target="_blank">Hexo</a> & <a href="https://theme-next.js.org/pisces/" rel="noopener" target="_blank">NexT.Pisces</a>
  </div>

    </div>
  </footer>

  
  <script src="https://cdn.jsdelivr.net/npm/animejs@3.2.1/lib/anime.min.js" integrity="sha256-XL2inqUJaslATFnHdJOi9GfQ60on8Wx1C2H8DYiN1xY=" crossorigin="anonymous"></script>
<script src="/js/comments.js"></script><script src="/js/utils.js"></script><script src="/js/motion.js"></script><script src="/js/next-boot.js"></script><script src="/js/bookmark.js"></script>

  





  
  <script async src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>





</body>
</html>
